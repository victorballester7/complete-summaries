\documentclass[../../../main_math.tex]{subfiles}

\begin{document}
\changecolor{INEPDE}
\begin{multicols}{2}[\section{Introduction to nonlinear elliptic PDEs}]
  \subsection{Introduction}
  \begin{definition}
    Let $a_{ij}$, $b_j$, $c$, $f$ be known scalar functions defined on $\Omega\subseteq \RR^d$. Usually we will denote $\vf{A}=(a_{ij})$ and $\vf{b}=(b_j)$. A \emph{linear second-order PDE} is an equation of the form:
    \begin{equation*}
      -\sum_{i,j=1}^da_{ij}(\vf{x})\partial_{ij}^2u(\vf{x})+\sum_{j=1}^db_j(\vf{x})\partial_ju(\vf{x})+c(\vf{x})u(\vf{x})=f(\vf{x})
    \end{equation*}
    where $u:\Omega\to \RR$ is the unknown function. This form is called \emph{non-divergence form}. If we write the equation in the form:
    \begin{multline*}
      -\sum_{i=1}^d\pdv{}{x_i}\left(\sum_{j=1}^da_{ij}(\vf{x})\partial_ju(\vf{x})\right)+\sum_{j=1}^db_j(\vf{x})\partial_ju(\vf{x})+\\+c(\vf{x})u(\vf{x})=f(\vf{x})
    \end{multline*}
    then we say that the equation is in \emph{divergence form}. Together with the PDE we usually impose boundary conditions on $\Fr{\Omega}$. The \emph{Dirichlet boundary condition} is:
    $$
      u|_{\Fr{\Omega}}=g
    $$
    and it is called \emph{homogeneous} if $g=0$. The \emph{Neumann boundary condition} is:
    $$
      \langle \vf{n},\vf{A} \grad u\rangle|_{\Fr{\Omega}}=g
    $$
    where we have assumed that the boundary of $\Omega$ is smooth enough to define the normal vector $\vf{n}$. The condition is called \emph{homogeneous} if $g=0$. Note that if $\vf{A}=\vf{I}_d$, then the Neumann boundary condition is just $\partial_{\vf{n}} u=g$.
  \end{definition}
  \begin{remark}
    If the coefficients $a_{ij}\in\mathcal{C}^1$, then we are able to convert the equation from non-divergence form to divergence form and vice versa.
  \end{remark}
  \begin{definition}
    Let $a_{ij},b_j,c$ be known functions on $\Omega\subseteq \RR^d$. We say that the operator
    \begin{equation}\label{INEPDE:operator}
      L=-\sum_{i,j=1}^da_{ij}\partial_{ij}^2 + \sum_{j=1}^d b_j\partial_j+c
    \end{equation}
    is \emph{uniformly elliptic} if there exists $\theta>0$ such that for all $x\in \Omega$ and all $\vf{p}\in \RR^d$ we have:
    \begin{equation*}
      Q_x(\vf{p}):=\transpose{\vf{p}}\vf{A}(\vf{x})\vf{p}=\!\sum_{i,j=1}^da_{ij}(\vf{x})p_ip_j\geq \theta \sum_{i=1}^{d} {p_i}^2=\theta \norm{\vf{p}}^2
    \end{equation*}
  \end{definition}
  \begin{remark}
    Geometrically speaking, this implies that the sets
    $$
      \xi_{x,h}=\{ \vf{p}\in \RR^d: Q_x(\vf{p})=h\}
    $$
    are ellipsoids.
  \end{remark}
  \begin{definition}
    Consider the problem
    $$
      \mathcal{D}_f:=\begin{cases}
        Lu=f & \text{in }\Omega      \\
        u=0  & \text{on }\Fr{\Omega}
      \end{cases}
    $$
    where $L$ is as in \mcref{INEPDE:operator}. The \emph{weak formulation} (or \emph{variational formulation}) of the problem is:
    \begin{equation*}
      {\langle \grad u,\grad v\rangle}_2+{\langle \vf{b}\cdot \grad u,v\rangle}_2 + {\langle cu,v\rangle}_2={\langle f,v\rangle}_2\quad \forall v\in H_0^1(\Omega)
    \end{equation*}
    A solution of such problem is called a \emph{weak solution} of $\mathcal{D}_f$.
  \end{definition}
  \begin{definition}
    If the weak solution $u_f$ of the problem $\mathcal{D}_f$ is in $H^1_0(\Omega)\cap W^{2,p}(\Omega)$ for some $p\in [1,\infty)$, then $u_f$ is called a \emph{strong solution} of $\mathcal{D}_f$. If $u_f\in \mathcal{C}^2(\Omega)\cap H^1_0(\Omega)$, then we say that $u_f$ is a \emph{classical solution} of $\mathcal{D}_f$.
  \end{definition}
  \begin{proposition}
    Let $H$ be Hilbert and $K:H\to H$ be a continuous linear operator. Then, the following are equivalent:
    \begin{enumerate}
      \item $K$ is compact.
      \item For any bounded sequence $(u_n)\in H$, the sequence $(Ku_n)$ has a convergent subsequence.
      \item For any sequence $(u_n)\in H$ such that $u_n\rightharpoonup u$, we have $Ku_n\to Ku$.
    \end{enumerate}
  \end{proposition}
  \subsection{Hilbert space methods for divergence form linear PDEs}
  In this section, we will assume that $\Omega\subset\RR^d$ is an open, bounded subset, $a_{ij}=a_{ji}$ and $a_{ij},b_j,c\in L^\infty(\Omega)$.
  \subsubsection{Lax-Milgram theorem}
  \begin{remark}
    Instead of the usual norm for $H_0^1(\Omega)$, here we will use the following one:
    $$
      \norm{u}_{H_0^1(\Omega)}^2=\norm{\grad u}_{L^2(\Omega)}^2
    $$
  \end{remark}
  \begin{definition}
    Let $H$ be a Hilbert space and $a:H\times H\rightarrow\RR$ be a bilinear map. We say that $a$ is \emph{continuous} if $\exists C>0$ such that $\forall u,v\in H$ we have: $$\abs{a(u,v)}\leq C\norm{u}\norm{v}$$
  \end{definition}
  \begin{definition}
    Let $H$ be a Hilbert space and $a:H\times H\rightarrow\RR$ be a bilinear map. We say that $a$ is \emph{coercive} if $\exists\alpha>0$ such that $\forall u\in H$ we have: $$a(u,u)\geq\alpha\norm{u}^2$$
  \end{definition}
  \begin{definition}
    Let $H$ be a Hilbert space and $a:H\times H\rightarrow\CC$ be a bilinear map. We say that $a$ is \emph{symmetric} if $\forall u,v\in H$ we have: $$a(u,v)=\overline{a(v,u)}$$
  \end{definition}
  \begin{theorem}[Lax-Milgram theorem]\label{INEPDE:laxmilgram}
    Let $H$ be a Hilbert space and $a:H\times H\rightarrow\RR$ be a continuous and coercive bilinear map. Then, $\forall f\in H^*$ $\exists! u_f\in H$ such that: $$a(u_f,v)=f(v)\quad \forall v\in H$$
    In addition, if ${H}$ is a real Hilbert space and $a$ is symmetric, then $u$ is the unique minimizer of:
    $$\min_{v\in H}\left\{\frac{1}{2}a(v,v)-f(v)\right\}$$
  \end{theorem}
  \begin{proposition}
    Consider the problem:
    $$
      \begin{cases}
        L u=f & \text{in }\Omega      \\
        u=0   & \text{on }\Fr{\Omega}
      \end{cases}
    $$
    with $L=-\sum_{i,j=1}^d\partial_i(a_{ij}\partial_j)$ and $f\in L^2(\Omega)$. Then, the problem has a unique weak solution $u\in H_0^1(\Omega)$ and
    $$
      \norm{u}_{H_0^1(\Omega)}\leq C\norm{f}_{L^2(\Omega)}
    $$
  \end{proposition}
  \begin{proof}
    Consider the bilinear form $$
      a(u,v):=\int_\Omega\sum_{i,j=1}^da_{ij}\partial_iu\partial_jv
    $$
    We check the hypotheses of \mnameref{INEPDE:laxmilgram}:
    \begin{enumerate}
      \item $a$ is continuous:
            \begin{align*}
              \abs{a(u,v)} & \leq \sum_{i,j=1}^d\norm{a_{ij}}_{\infty}\norm{\grad u}_{2}\norm{\grad v}_{2} \\
                           & \leq C\norm{u}_{H_0^1(\Omega)}\norm{v}_{H_0^1(\Omega)}
            \end{align*}
      \item $a$ is coercive:
            \begin{align*}
              a(u,u) & =\int_\Omega\sum_{i,j=1}^da_{ij}\partial_iu\partial_ju   \\
                     & \geq \theta \int_\Omega\sum_{i=1}^d{\abs{\partial_iu}}^2 \\
                     & =\theta {\norm{u}_{H_0^1(\Omega)}}^2
            \end{align*}
            by the uniform ellipticity of $L$.
    \end{enumerate}
    Moreover, since $ a(u,u)={\langle f,u\rangle}_2$ we have that:
    \begin{align*}
      \theta {\norm{u}_{H_0^1(\Omega)}}^2\leq {\langle f,u\rangle}_2\leq \norm{f}_2\norm{u}_{2}\leq C \norm{f}_2\norm{u}_{H_0^1(\Omega)}
    \end{align*}
    by the \mnameref{ATFAPDE:poincare_ineq}.
  \end{proof}
  \subsubsection{Abstract Fredholm alternative}
  \begin{remark}
    One can check that if we try to apply \mnameref{INEPDE:laxmilgram} to the problem:
    $$
      \begin{cases}
        Lu=f & \text{in }\Omega      \\
        u=0  & \text{on }\Fr{\Omega}
      \end{cases}
    $$
    with $L=-\sum_{i,j=1}^d\partial_i(a_{ij}\partial_j)+\sum_{j=1}^db_j\partial_j$, it fails due to the coercivity condition.
  \end{remark}
  \begin{proposition}\label{INEPDE:Lmu}
    Consider the problem:
    $$
      \mathcal{D}_{\mu,f}:=\begin{cases}
        L_\mu u=f & \text{in }\Omega      \\
        u=0       & \text{on }\Fr{\Omega}
      \end{cases}
    $$
    with $L_\mu=-\sum_{i,j=1}^d\partial_i(a_{ij}\partial_j)+\sum_{j=1}^db_j\partial_j+\mu$. Then, if $\mu>0$ is large enough, the problem has a unique weak solution in $H_0^1(\Omega)$
  \end{proposition}
  \begin{sproof}
    Taking the natural bilinear map $a$, the coercivity condition becomes:
    $$
      a_\mu(u,u)\geq \theta \norm{u}_{H_0^1(\Omega)}^2-C\norm{u}_{H_0^1(\Omega)}\norm{u}_2 + \mu \norm{u}_2^2
    $$
    which for $\mu$ large enough it is bigger than $\delta \norm{u}_{H_0^1(\Omega)}^2$ for some $\delta>0$.
  \end{sproof}
  \begin{lemma}\label{INEPDE:lemma1_fredholm}
    Let $H$ be Hilbert and $K:H\to H$ be a compact linear operator. Then, $\dim \ker(\id-K)<\infty$.
  \end{lemma}
  \begin{proof}
    If $\dim\ker(\id-K)=\infty$, then $\exists (u_n)\in \ker(\id-K)$ orthonormal, and thus bounded. In particular, $u_n=Ku_n$ and since $K$ is compact, we have that $(Ku_n)$ has a convergent subsequence. But:
    \begin{align*}
      0 & =\lim_{k\to\infty}\norm{Ku_{n_k}-Ku_{n_{k+1}}}^2        \\
        & =\lim_{k\to\infty}\norm{u_{n_k}-u_{n_{k+1}}}^2          \\
        & =\lim_{k\to\infty}\norm{u_{n_k}}^2+\norm{u_{n_{k+1}}}^2 \\
        & =2
    \end{align*}
    by \mnameref{RFA:pythagorean}.
  \end{proof}
  \begin{lemma}\label{INEPDE:lemma2_fredholm}
    Let $H$ be Hilbert and $K:H\to H$ be a compact linear operator. Then, $\exists c>0$ such that $\forall u\in {\ker(\id-K)}^{\perp}$ we have $\norm{u-Ku}\geq c\norm{u}$.
  \end{lemma}
  \begin{proof}
    We proceed by contradiction. Suppose we have a sequence $(u_n)\in {\ker(\id-K)}^{\perp}$ with $\norm{u_n}=1$ such that $\norm{u_n-Ku_n}\to 0$. Since $(u_n)$ is bounded, we have that $(u_n)$ has a weakly convergent subsequence $(u_{n_k})$ to $u\in H$. Since $K$ is compact, we have that $Ku_{n_k}\to Ku$, and thus by continuity of the norm, $u=Ku$. Thus $u\in \ker(\id-K)$ and $u\in {\ker(\id-K)}^{\perp}$, which implies $u=0$, a contraction with $\norm{u}=1$.
  \end{proof}
  \begin{lemma}\label{INEPDE:lemma3_fredholm}
    Let $H$ be Hilbert and $K:H\to H$ be a compact linear operator. Then, $\im(\id-K)$ is closed.
  \end{lemma}
  \begin{proof}
    Let $(v_n)\in \im(\id-K)$ be such that $v_n\to v\in H$. Then, $\exists (u_n)\in H$ such that $v_n=(\id-K)u_n$. By \mnameref{RFA:projection}, we can write $u_n=u_n^{\text{ker}}+ u_n^{\text{ker}^\perp}$, where $u_n^{\text{ker}}\in \ker(\id-K)$ and $u_n^{\text{ker}^\perp}\in {\ker(\id-K)}^{\perp}$. Thus, $v_n=(\id-K)u_n^{\text{ker}^\perp}$ and by \mcref{INEPDE:lemma2_fredholm}, we have:
    $$
      \norm{v_n-v_m}\geq c\norm{u_n^{\text{ker}^\perp}-u_m^{\text{ker}^\perp}}
    $$
    Since $(v_n)$ is Cauchy, so it is $(u_n^{\text{ker}^\perp})$, and thus $(u_n^{\text{ker}^\perp})$ converges to some $u\in {\ker(\id-K)}^{\perp}$. Thus, $v=(\id-K)u\in \im(\id-K)$.
  \end{proof}
  % \begin{lemma}
  %   Let $H$ be Hilbert and $K:H\to H$ be a compact linear operator. Then, $\ker(\id-K)=\{0\}\iff \ker(\id-K^*)=\{0\}$.
  % \end{lemma}
  % \begin{proof}
  %   The argument is symmetric since $K^{**}=K$ and $K$ is compact $\iff K^*$ is compact. So suppose $\ker(\id-K)=\{0\}$. Then, $\id -K$ is injective.
  % \end{proof}
  \begin{theorem}[Abstract Fredholm alternative]\label{INEPDE:fredholm}
    Let $H$ be Hilbert and $K:H\to H$ be a compact linear operator. Then:
    \begin{enumerate}
      \item $\ker(\id-K)$ and $\ker(\id-K^*)$ are both finite dimensional, and they have the same dimension.
      \item $\im(\id-K)={\ker(\id-K^*)}^\perp$. In particular, $\im(\id-K)$ is closed.
      \item Either $\ker(\id-K)\ne\{0\}$ or $\id -K$ is an isomorphism.
    \end{enumerate}
  \end{theorem}
  \begin{proof}
    \begin{enumerate}
      \setcounter{enumi}{1}
      \item From \mcref{RFA:adjoint_im_ker} we have that $\overline{\im A}={(\ker A^*)}^\perp$ for any general operator $A$ between Hilbert spaces. Thus, $\im(\id-K)={\ker(\id-K^*)}^\perp\iff \im(\id-K)$ is closed, which reduces to \mcref{INEPDE:lemma3_fredholm}.
      \item We first show that $\ker(\id-K)=\{0\}\iff \ker(\id-K^*)=\{0\}$. The argument is symmetric because $K^{**}=K$ and the fact that $K$ is compact $\iff K^*$ is compact. So suppose $\ker(\id-K)=\{0\}$. Then, $\id -K$ is injective. Assume $\ker(\id-K^*)\ne\{0\}$. Then, $\im (\id-K)=\ker(\id-K^*)^\perp\ne H$ and so $\im({(\id-K)}^2)\subsetneq \im(\id-K)$. Indeed, if we had equality, then for any $u\in H$, we would have ${(\id-K)u}\in \im({(\id-K)}^2)$, and thus $\exists v\in H$ such that ${(\id-K)u}={(\id-K)}^2v$, which implies $u={(\id-K)}v$ because $\ker (\id-K)=\{0\}$. Now, recursively, we have an infinite sequence $\im({(\id-K)}^{n+1})\subsetneq \im({(\id-K)}^n)$, which implies that $\forall n$ $\exists u_n\in \im({(\id-K)}^n)\cap\im({(\id-K)}^{n+1})^\perp$ with $\norm{u_n}=1$. Thus, $\langle u_n,u_m\rangle=\delta_{n,m}$. But $u_n-Ku_n\in \im({(\id-K)}^{n+1})$ so, $u_n-Ku_n\perp u_n$. This implies, by \mnameref{RFA:pythagorean}, that $\norm{Ku_n}^2=\norm{u_n-Ku_n}^2+\norm{u_n}^2\geq 1$, which is a contradiction with the compactness of $K$ because any orthonormal sequence always converges weakly to zero (and so $Ku_n\to 0$). So either $\ker(\id-K)\ne\{0\}$ or $\id-K$ is bijective.

            To finish this point, we need to prove that if $\ker(\id-K)=\{0\}$, then ${(\id-K)}^{-1}$ is a bounded linear operator. But this is a consequence of \mcref{INEPDE:lemma2_fredholm}: if $u\in H$, then $u\in \ker {(\id-K)}^\perp$ and thus $\norm{(\id-K)u}\geq c\norm{u}$, which implies that $\norm{v}\geq c \norm{{(\id-K)}^{-1}v}$ taking $v=(\id-K)u$.
            \setcounter{enumi}{0}
      \item Assume without loss of generality that $\dim\ker(\id-K)<\dim \ker(\id-K^*)$. Then, there exists a linear injective map $A:\ker(\id-K)\to \ker(\id-K^*)=\im(\id-K)^\perp$. Let $\tilde{K}$ be the operator defined by $\tilde{K}u=Ku+Au^{\text{ker}}$, where $u^{\text{ker}}$ is the projection of $u$ onto $\ker(\id-K)$. Then, $\tilde{K}$ is compact (because $K$ is compact and so is $A$, because it has finite range). Moreover, if $u\in \ker(\id-\tilde{K})$, then $(\id-K)u-Au^{\text{ker}}=0$, which since $(\id-K)u\in \im(\id-K)$ and $Au^{\text{ker}}\in \im(\id-K)^\perp$ implies that both terms are zero. So $u=u^{\text{ker}}\in \ker(\id-K)$ and since $A$ is injective, $u=u^{\text{ker}}=0$. Thus, $\ker(\id-\tilde{K})=\{0\}$ and by the previous point, $\id-\tilde{K}$ is an isomorphism from $H$ to itself. So, for every $w\in \ker(\id-K^*)$, $\exists u\in H$ such that $w=(\id-\tilde{K})u$. Projecting both sides onto $\ker(\id-K^*)=\im(\id-K)^\perp$, we have $w=-Au^{\text{ker}}$, which implies that $A$ is onto, and so $\dim\ker(\id-K)=\dim\ker(\id-K^*)$. \mcref{INEPDE:lemma1_fredholm} finishes the proof.
    \end{enumerate}
  \end{proof}
  \begin{definition}
    Consider the operator $L$ as in \mcref{INEPDE:operator}. We define the \emph{formal adjoint} of $L$ as:
    \begin{align*}
      L^*v := & -\sum_{i,j=1}^d\partial_i(a_{ij}\partial_jv)-\sum_{j=1}^d\partial_j(b_jv)+c v                                      \\
      =       & -\sum_{i,j=1}^d\partial_i(a_{ij}\partial_jv)-\sum_{j=1}^db_j\partial_jv+ \left(c-\sum_{j=1}^d\partial_jb_j\right)v
    \end{align*}
    It satisfies $\langle Lu,v\rangle=\langle u,L^*v\rangle$ for all $u,v\in H_0^1(\Omega)$.
  \end{definition}
  \begin{proposition}\label{INEPDE:adjoint_im_ker}
    The \emph{homogeneous adjoint problem}
    $$
      \mathcal{D}_0^*:=\begin{cases}
        L^*v=0 & \text{in }\Omega      \\
        v=0    & \text{on }\Fr{\Omega}
      \end{cases}
    $$
    whose weak formulation is
    \begin{equation*}
      {\langle \grad v,\grad w\rangle}_2+{\langle \vf{b}\cdot \grad v,w\rangle}_2=0\quad \forall w\in H_0^1(\Omega)
    \end{equation*}
    has a finite dimensional solution space $W_0$, the space $V_0$ of solutions of $\mathcal{D}_0$ has also finite dimension and $\dim W_0=\dim V_0$. Moreover, if $f\in L^2(\Omega)$, $\mathcal{D}_f$ is solvable if and only if $\langle f,v\rangle=0$ for all $v\in W_0$.
  \end{proposition}
  \begin{proof}
    We saw in \mcref{INEPDE:Lmu} that for $\mu\geq \mu_0>0$, $L_\mu$ is an isomorphism. Now we want to solve $L_0u=f$. Consider the change of variables $u={L_{\mu_0}}^{-1}w$, with $w=L_{\mu_0}u\in H^{-1}(\Omega)$. Thus, the equation becomes:
    $$
      f= (L_{\mu_0}-\mu_0){L_{\mu_0}}^{-1}w=w-\mu_0 {L_{\mu_0}}^{-1}w=(\id-K)w
    $$
    with $K=\mu_0 {L_{\mu_0}}^{-1}$. We claim that $K:L^2(\Omega)\to L^2(\Omega)$ is compact. Note that $K=\mu_0\iota_{H_0^1\hookrightarrow L^2}\circ {L_{\mu_0}}^{-1}\circ \iota_{L^2\hookrightarrow H^{-1}}$, so since ${L_{\mu_0}}^{-1}$ and $\iota_{L^2\hookrightarrow H^{-1}}$ are bounded, and we have a compact embedding $H_0^1\hookrightarrow L^2$, we have that $K$ is compact. Finally, one can check that:
    $$
      \id-K^*={(\id-K)}^*={\left(L_0{L_{\mu_0}}^{-1}\right)}^*={({L_{\mu_0}}^*)}^{-1}{L_0}^{*}
    $$
    By \mnameref{INEPDE:fredholm}, we have that $(\id-K)w=f$ has a solution if and only if $(\id-K^*)h=0\implies \langle f,h\rangle_{L^2} =0$ for all $h\in L^2$. But ${L_{\mu_0}}^*$ is an isomorphism, so $(\id-K^*)h=0\iff {L_0}^*h=0$.
  \end{proof}
  \begin{definition}
    We define the following problem:
    $$
      \mathcal{N}_f:=\begin{cases}
        -\laplacian u=f   & \text{in }\Omega      \\
        \pdv{u}{\vf{n}}=0 & \text{on }\Fr{\Omega}
      \end{cases}
    $$
    and $\mathcal{N}_f^*=\mathcal{N}_f$. The weak formulation of the problem is:
    \begin{equation*}
      \langle \grad u,\grad v\rangle=\langle f,v\rangle\quad \forall v\in H^1(\Omega)
    \end{equation*}
  \end{definition}
  \begin{proposition}
    $\mathcal{N}_f$ has at least one solution if and only if for any weak solution $v$ of $\mathcal{N}_0$ we have $\langle f,v\rangle=0$.
  \end{proposition}
  \subsubsection{Spectrum of compact operators}
  In this section $\KK$ will denote either $\RR$ or $\CC$.
  \begin{definition}
    Let $H$ be a $\KK$-Hilbert space and $K:H\to H$ be a bounded operator. We define the \emph{resolvent set} of $K$ as:
    $$
      \rho(K)=\{\lambda\in \KK: \lambda\id-K \text{ is invertible}\}
    $$
    and the \emph{spectrum} of $K$ as:
    $$
      \sigma(K)=\KK\setminus \rho(K)
    $$
  \end{definition}
  \begin{proposition}
    Let $H$ be a $\KK$-Hilbert space and $T:H\to H$ be a bounded operator. Then, $\sigma(T)$ is closed.
  \end{proposition}
  \begin{proof}
    Note that $\rho(K)$ is open because if $\lambda\in \rho(T)$, then $\exists\varepsilon\in\RR$ such that $\abs{\varepsilon} < \norm{{(\lambda\id-K)}^{-1}}$. And so $(\lambda+\varepsilon)\id-K$ is invertible. Thus, $\sigma(K)$ is closed.
  \end{proof}
  \begin{theorem}
    Let $H$ be an infinite-dimensional separable Hilbert space and $K:H\to H$ be a compact operator. Then:
    \begin{enumerate}
      \item $0\in \sigma(K)$.
      \item\label{INEPDE:item2_spectrum} If $\lambda\in \sigma(K)\setminus\{0\}$, then $\lambda$ is an eigenvalue of $K$.
      \item $\sigma(K)$ is closed and at most countable.
      \item If $\sigma(K)\cap\RR$ is infinite, then $\sigma(K)\setminus\{0\}$ is of the form $\{\lambda_n\}_{n\in \NN}$ with $\lambda_n\to 0$.
      \item If $\lambda\in \sigma(K)\setminus\{0\}$, then:
            $$
              \dim\left(\bigcup_{p\geq 1}\ker{(\lambda\id-K)}^p\right)<\infty
            $$
    \end{enumerate}
  \end{theorem}
  \begin{proof}
    \begin{enumerate}
      \item Assume $0\notin \sigma(K)$. Then, $K$ is bijective and so $\id = K\circ K^{-1}$ is compact, as it is the composition of a compact operator and a bounded operator. But this is a contradiction with \mnameref{RFA:riesz_ball} because the image of any bounded set under a compact operator is relatively compact (or \emph{precompact}).
      \item If $\ker(\lambda\id-K)=\{0\}$, then by \mnameref{INEPDE:fredholm}, $\lambda\id-K$ is an isomorphism, and thus $\lambda\in \rho(K)$.
            \setcounter{enumi}{3}
            % \item If $(\lambda_n)\in \sigma(K)\setminus\{0\}$ is an infinite sequence, then by \mcref{INEPDE:item2_spectrum} we have that $\exists (u_n)\in H$ with $\norm{u_n}=1$ such that $Ku_n=\lambda_nu_n$.
    \end{enumerate}
  \end{proof}
  \begin{lemma}
    Let $H$ be a Hilbert space and $T:H\to H$ be a continuous self-adjoint operator. Then:
    $$
      \norm{T}=\sup_{\norm{x}=1}\abs{\langle x,Tx\rangle}
    $$
  \end{lemma}
  \begin{proof}
    Clearly $\displaystyle\alpha:=\sup_{\norm{x}=1}\abs{\langle x,Tx\rangle}\leq \norm{T}$. For the converse, it suffices to show that $\abs{\langle Tx,y\rangle}\leq \alpha$ for all $\norm{x}=\norm{y}=1$. We have:
    $$
      \langle Tx,y\rangle = \frac{1}{4}\left(\langle T(x+y),x+y\rangle-\langle T(x-y),x-y\rangle\right)
    $$
    And then, by \mnameref{RFA:parallelogram}:
    $$
      \abs{\langle Tx,y\rangle}\leq \frac{\alpha}{4}\left(\norm{x+y}^2+\norm{x-y}^2\right)= \alpha
    $$
  \end{proof}
  \begin{lemma}
    Let $H\ne\{ 0\}$ be Hilbert and $K:H\to H$ be a compact and self-adjoint operator. Then:
    $$
      \sup_{\norm{x}=1}\langle x,Kx\rangle=\lambda
    $$
    where $\lambda$ is the largest eigenvalue of $K$.
  \end{lemma}
  \begin{proof}
    Let $(x_n)$ be a maximizing sequence with $\norm{x_n}=1$. After extraction, we can assume that $x_n\rightharpoonup x_*$ and so $Kx_n\to Kx_*$. Thus, $\langle x_n,Kx_n\rangle\to \langle x_*,Kx_*\rangle$. So $x_*$ is a maximizer. Now, take $h\perp x_*$ and $\norm{h}=1$. Then, $x_t:=\frac{x_*+th}{\sqrt{1+t^2}}$ satisfies $\norm{x_t}=1$ and:
    $$
      \langle x_t,Kx_t\rangle=\langle x_*,Kx_*\rangle+2t\langle h,Kx_*\rangle+\o{t}\leq \langle x_*,Kx_*\rangle
    $$
    because of the maximality. So we must have $\langle h,Kx_*\rangle=0$, which implies $Kx_*\in {{({\langle x_*\rangle}^\perp)}^\perp}=\langle x_*\rangle$. Thus, $Kx_*=\lambda x_*$.
  \end{proof}
  \subsubsection{Regularity theorems for weak solutions of divergence-form elliptic PDEs}
  \begin{theorem}[Inner regularity]
    Assume, in addition to the usual assumptions, that $a_{ij}\in \mathcal{C}^1(\Omega)$. Let $f\in L^2(\Omega)$ and $u\in H^1(\Omega)$ be a weak solution of $Lu=f$. Then, $u\in H^2_{\text{loc}}(\Omega)$ and for any compact embedding $\omega\subset\subset \Omega$, meaning that $\overline{\omega}\subset\Omega$ compact, we have $u\in H^2(\omega)$ and:
    $$
      \norm{u}_{H^2(\omega)}\leq C\left(\norm{f}_{L^2(\Omega)}+\norm{u}_{L^2(\Omega)}\right)
    $$
  \end{theorem}
  \begin{corollary}
    Assume that $a_{ij}\in\mathcal{C}^{m+1}(\Omega)$ for some $m\in\NN$, and $b_j,c\in \mathcal{C}^{m}(\Omega)$. Let $f\in H^{m}(\Omega)$ and $u\in H^1$ be a weak solution of $Lu=f$. Then, $u\in H^{m+2}_{\text{loc}}(\Omega)$ and for any $\omega\subset\subset \Omega$ we have $u\in H^{m+2}(\omega)$ and:
    $$
      \norm{u}_{H^{m+2}(\omega)}\leq C\left(\norm{f}_{H^{m}(\Omega)}+\norm{u}_{L^2(\Omega)}\right)
    $$
  \end{corollary}
  \begin{corollary}
    Assume $a_{ij},b_j,c,f\in\mathcal{C}^\infty(\Omega)$. Let $u\in H^1(\Omega)$ be a weak solution of $Lu=f$. Then, $u\in \mathcal{C}^\infty(\Omega)$.
  \end{corollary}
  \begin{theorem}[Regularity up to the boundary]
    Assume that $\Fr{\Omega}$ is $\mathcal{C}^2$ and that $a_{ij}\in \mathcal{C}^1(\overline{\Omega})$, $b_j,c\in L^\infty(\Omega)$. Let $f\in L^2(\Omega)$ and $u\in H^1_0(\Omega)$ be a weak solution of $\mathcal{D}_f$. Then, $u\in H^2(\Omega)$ and:
    $$
      \norm{u}_{H^2(\Omega)}\leq C\left(\norm{f}_{L^2(\Omega)}+\norm{u}_{L^2(\Omega)}\right)
    $$
  \end{theorem}
  \begin{corollary}
    Assume that $\Fr{\Omega}$ is $\mathcal{C}^{m+2}$, $m\in\NN$, and that $a_{ij}\in \mathcal{C}^{m+1}(\overline{\Omega})$, $b_j,c\in \mathcal{C}^{m}(\overline{\Omega})$. Let $f\in H^{m}(\Omega)$ and $u\in H^1_0(\Omega)$ be a weak solution of $\mathcal{D}_f$. Then, $u\in H^{m+2}(\Omega)$ and:
    $$
      \norm{u}_{H^{m+2}(\Omega)}\leq C\left(\norm{f}_{H^{m}(\Omega)}+\norm{u}_{L^2(\Omega)}\right)
    $$
  \end{corollary}
  \begin{corollary}
    Assume that $\Fr{\Omega}$ is $\mathcal{C}^\infty$ and that $a_{ij},b_j,c,f\in \mathcal{C}^\infty(\overline{\Omega})$. Let $u\in H^1_0(\Omega)$ be a weak solution of $\mathcal{D}_f$. Then, $u\in \mathcal{C}^\infty(\Omega)$ and $\forall m\in \NN$:
    $$
      \norm{u}_{H^{m}(\Omega)}\leq C\left(\norm{f}_{H^{m}(\Omega)}+\norm{u}_{L^2(\Omega)}\right)
    $$
  \end{corollary}
  \subsubsection{Weak maximum principle for weak solutions of divergence-form elliptic PDEs}
  \begin{lemma}\label{INEPDE:lemma1_weak_max}
    Let $\Omega\subseteq\RR^d$ open and $u\in H^1(\Omega)$. Then:
    $$
      u^{+}:=\begin{cases}
        u & \text{if }u> 0    \\
        0 & \text{if }u\leq 0
      \end{cases}\qquad
      u^{-}:=\begin{cases}
        -u & \text{if }u< 0    \\
        0  & \text{if }u\leq 0
      \end{cases}
    $$
    are also in $H^1(\Omega)$ and:
    $$
      \grad(u^+)\almoste{=}\begin{cases}
        \grad u & \text{if }u>0     \\
        0       & \text{if }u\leq 0
      \end{cases}\;\;
      \grad(u^-)\almoste{=}\begin{cases}
        -\grad u & \text{if }u<0     \\
        0        & \text{if }u\geq 0
      \end{cases}
    $$
  \end{lemma}
  \begin{corollary}
    Let $\Omega\subseteq\RR^d$ open and $u\in H^1(\Omega)$. Then, $\abs{u}\in H^1(\Omega)$ and $\grad{\abs{u}}=\sign\grad{u}$.
  \end{corollary}
  \begin{lemma}
    Let $(u_n)\in H^1(\Omega)$ be such that $u_n\overset{H^1(\Omega)}{\longrightarrow} u$. Then, ${u_n}^\pm\overset{H^1(\Omega)}{\longrightarrow} u^\pm$.
  \end{lemma}
  \begin{corollary}
    Let $u\in H^1(\Omega)$. Then, $\Tr_{\Fr{\Omega}}(u^\pm)={(\Tr_{\Fr{\Omega}}u)}^\pm$.
  \end{corollary}
  \begin{lemma}\label{INEPDE:lemma3_weak_max}
    Let $\Omega\subseteq\RR^d$ open with $\mathcal{C}^1$ boundary, $u\in H^1(\Omega)$ and $\Tr_{\Fr{\Omega}}u\almoste{\leq}0$. Then, $u^+\in H^1_0(\Omega)$.
  \end{lemma}
  \begin{theorem}[Weak maximum principle]
    Let $\Omega\subseteq\RR^d$ open and bounded with $\mathcal{C}^1$ boundary, $a_{ij}=a_{ji},c\in L^\infty(\Omega)$, $c\almoste{\geq}0$, $L=-\sum_{i,j=1}^d\partial_i(a_{ij}\partial_j)+c$ be elliptic and $f\in L^2(\Omega)$ with $f\almoste{\leq} 0$. Let $u\in H^1(\Omega)$ be such that:
    \begin{itemize}
      \item $\displaystyle \int_\Omega\left[\sum_{i,j=1}^da_{ij}\partial_iu\partial_jv+cuv\right]=\int_\Omega fv$ $\forall v\in H^1_0(\Omega)$
      \item $\Tr_{\Fr{\Omega}}u\almoste{\leq}0$
    \end{itemize}
    Then, $u\almoste{\leq}0$.
  \end{theorem}
  \begin{proof}
    Take $v=u^+\in H^1_0(\Omega)$ by \mcref{INEPDE:lemma3_weak_max}. Then, we have:
    $$
      0\leq \theta {\norm{\grad u^+}_{L^2}}^2\leq\!\! \int_{\{u>0\}}\!\!\sum_{i,j=1}^d a_{ij}\partial_iu\partial_ju+cu^2=\!\!\int_{\{u>0\}} \!\!fu\leq 0
    $$
    where in the second inequality we used the ellipticity of $L$. Thus, we must have $\grad u^+=0$ a.e. in $\Omega$, which implies $u^+=0$ a.e. in $\Omega$, because $u^+|_{\Fr{\Omega}}=0$.
  \end{proof}
  \begin{theorem}[Weak maximum principle]\label{INEPDE:weak_max_principle}
    Let $\Omega\subseteq\RR^d$ open and bounded with $\mathcal{C}^1$ boundary, $a_{ij}=a_{ji},b_j,c\in L^\infty(\Omega)$, $c \almoste{\geq}0$, $L=-\sum_{i,j=1}^d\partial_i(a_{ij}\partial_j)+\sum_{j=1}^db_j\partial_j+c$ be elliptic and $f\in L^2(\Omega)$ with $f\almoste{\leq} 0$. Let $u\in H^1(\Omega)$ be such that:
    \begin{itemize}
      \item $\displaystyle \int_\Omega\left[\sum_{i,j=1}^da_{ij}\partial_iu\partial_jv+ \sum_{j=1}^db_jv\partial_ju+cuv\right]=\int_\Omega fv$ $\forall v\in H^1_0(\Omega)$
      \item $\Tr_{\Fr{\Omega}}u\almoste{\leq}0$
    \end{itemize}
    Then, $u\almoste{\leq}0$.
  \end{theorem}
  \begin{proof}
    Let $m\geq 0$ and $v_m={(u-m)}^+$. Proceeding as in the previous proof, we have:
    \begin{align*}
      0 & \leq \theta \norm{\grad v_m}_{L^2}^2-d\norm{\vf{b}}_\infty\norm{\grad v_m}_{L^2}\norm{v_m}_{L^2}       \\
        & \leq \int_{\{u>m\}}\sum_{i,j=1}^d a_{ij}\partial_iu\partial_jv_m+\sum_{j=1}^db_j\partial_ju v_m+cu v_m \\
        & =\int_{\{u>m\}}fv_m\leq 0
    \end{align*}
    Thus, $\norm{\grad v_m}_{L^2}\leq C \norm{v_m}_{L^2}$, with $C$ independent of $m$. Note that since $\Omega$ is bounded, $\displaystyle\lim_{m\to\infty}\abs{\{u>m\}}=0$ by \mnameref{RFA:dominated}, and so $\displaystyle\lim_{m\to\infty}\supp v_m=0$ as well since $\supp v_m\subseteq \{u>m\}$. We now continue the proof for $d\geq 3$. By \mnameref{ATFAPDE:gagliardo_nirengerg_sobolev} we have a continuous embedding $H_0^1(\Omega)\hookrightarrow L^{2^*}$ with $\frac{1}{2^*}=\frac{1}{2}-\frac{1}{d}$. So, $\norm{v_m}_{L^{2^*}}\leq \delta \norm{\grad v_m}_{L^2}$. Thus:
    \begin{multline*}
      \norm{\grad v_m}_{L^2}\leq C \norm{v_m}_{L^2}\leq C{\abs{\supp v_m}}^{1-\frac{2}{2^*}}\norm{v_m}_{L^{2^*}}\leq \\
      \leq C\delta {\abs{\supp v_m}}^{1-\frac{2}{2^*}}\norm{\grad v_m}_{L^2}\leq \frac{1}{2} \norm{\grad v_m}_{L^2}
    \end{multline*}
    where in the second inequality we used \mnameref{RFA:holder} and the last one is valid for $m\geq m_0$ large enough. Thus, $\norm{\grad v_m}_{L^2}=0$ for $m\geq m_0$, which implies $u\almoste{\leq}m_0$. This means that $\abs{\{u>m_0\}}=0$ and that $\forall \varepsilon >0$, $\abs{\{u\geq m_0-\varepsilon\}}>0$. Suppose now that $m_0>0$ and let $S_\varepsilon=\abs{\{u> m_0-\varepsilon\}}$. Again by \mnameref{RFA:dominated}, $\displaystyle\lim_{\varepsilon\to 0}S_\varepsilon=0$. But then, proceeding as in the previous step:
    $$
      \norm{\grad v_{m_0-\varepsilon}}_{L^2}\leq C \delta {S_\varepsilon}^{1-\frac{2}{2^*}}\norm{\grad v_{m_0-\varepsilon}}_{L^2}\leq \frac{1}{2}\norm{\grad v_{m_0-\varepsilon}}_{L^2}
    $$
    by choosing $\varepsilon$ small enough. Thus, $\norm{\grad v_{m_0-\varepsilon}}_{L^2}=0$ and so $u\almoste{\leq}m_0-\varepsilon$, which is a contradiction. Thus, $m_0= 0$ (because $m_0\geq 0$ from the beginning) and so $u\almoste{\leq}0$.
  \end{proof}
  \begin{theorem}[Weak minimum principle]\label{INEPDE:weak_min_principle}
    Let $\Omega\subseteq\RR^d$ open and bounded with $\mathcal{C}^1$ boundary, $a_{ij}=a_{ji},b_j,c\in L^\infty(\Omega)$, $c \almoste{\geq}0$, $L=-\sum_{i,j=1}^d\partial_i(a_{ij}\partial_j)+\sum_{j=1}^db_j\partial_j+c$ be elliptic and $f\in L^2(\Omega)$ with $f\almoste{\geq} 0$. Let $u\in H^1(\Omega)$ be such that:
    \begin{itemize}
      \item $\displaystyle \int_\Omega\left[\sum_{i,j=1}^da_{ij}\partial_iu\partial_jv+ \sum_{j=1}^db_jv\partial_ju+cuv\right]=\int_\Omega fv$ $\forall v\in H^1_0(\Omega)$
      \item $\Tr_{\Fr{\Omega}}u\almoste{\geq}0$
    \end{itemize}
    Then, $u\almoste{\geq}0$.
  \end{theorem}
  \begin{sproof}
    Apply \mnameref{INEPDE:weak_max_principle} to $u\mapsto -u$ with $f\mapsto -f$.
  \end{sproof}
  \begin{corollary}\label{INEPDE:corollary_max_min}
    If $u$ is a weak solution of $\mathcal{D}_0$ with $c\geq 0$, then $u\almoste{=}0$.
  \end{corollary}
  \begin{proof}
    If $u$ is a weak solution of $\mathcal{D}_0$, then $u$ is a super- (that is, $Lu\geq 0$) and sub-solution (that is $Lu\leq 0$) of $\mathcal{D}_0$. Thus, using \mnameref{INEPDE:weak_max_principle} and \mnameref{INEPDE:weak_min_principle} we conclude that $u\almoste{=}0$.
  \end{proof}
  \begin{corollary}
    For each $f\in L^2(\Omega)$, the problem $\mathcal{D}_f$ has a unique weak solution $u_f$. Moreover, if $\Fr{\Omega}\in\mathcal{C}^1$, then $u_f\in H^2(\Omega)\cap H_0^1(\Omega)$ and $f\mapsto u_f$ is a bounded linear operator from $L^2(\Omega)$ to $H^2(\Omega)\cap H_0^1(\Omega)$. If $\Fr{\Omega}\in\mathcal{C}^{m+1}$, $b_j\in\mathcal{C}^{m-1}$ and $f\in H^{m-1}(\Omega)$, then $u_f\in H^{m+1}(\Omega)\cap H_0^1(\Omega)$ and $f\mapsto u_f$ is a bounded linear operator from $H^{m-1}(\Omega)$ to $H^{m+1}(\Omega)\cap H_0^1(\Omega)$.
  \end{corollary}
  \begin{sproof}
    \mnameref{INEPDE:fredholm} applied to this problem (check \mcref{INEPDE:adjoint_im_ker}) tells us that either there is a nonzero weak solution to $\mathcal{D}_0$ or $\mathcal{D}_f$ is solvable for all $f\in L^2(\Omega)$. But the first case is impossible by \mcref{INEPDE:corollary_max_min}.
  \end{sproof}
  \begin{theorem}
    Let $1<p<\infty$ and $\Omega\subset\RR^d$ be open and bounded with $\mathcal{C}^{m+1}$ boundary, $m\geq 1$. Let $a_{ij}\in \mathcal{C}^m(\overline{\Omega})$, $b_j,c\in \mathcal{C}^{m-1}(\overline{\Omega})$ and $Lu=-\sum_{i,j=1}^d \partial_i(a_{ij}\partial_j u)+\sum_{j=1}^d b_j\partial_j u+cu$ be an elliptic operator. Then, for any $f\in W^{m-1,p}(\Omega)$, if $u\in H^1_0(\Omega)$ is a weak solution of $\mathcal{D}_f$, then $u\in W^{m+1,p}(\Omega)$ and:
    $$
      \norm{u}_{W^{m+1,p}(\Omega)}\leq C\left(\norm{f}_{W^{m-1,p}(\Omega)}+\norm{u}_{L^2(\Omega)}\right)
    $$
    If in addition the weak solution of $\mathcal{D}_0$ is $u=0$, then $L:W^{m+1,p}(\Omega)\cap W_0^{1,p}(\Omega)\to W^{m-1,p}(\Omega)$ is an isomorphism, where $W_0^{1,p}(\Omega)$ is the closure of $C_0^\infty(\Omega)$ in $W^{1,p}(\Omega)$.
  \end{theorem}
  \subsection{Regularity in \texorpdfstring{$\mathcal{C}^{k,\alpha}$}{Ckalpha} for non-divergence form elliptic PDEs}

  In this section we will still always work in $\Omega\subset\RR^d$ open and bounded and the elliptic operator $L$ (with ellipticity constant $\theta$) will be in its non-divergence form:
  $$
    L=-\sum_{i,j=1}^d a_{ij}\partial_{ij}^2+\sum_{j=1}^d b_j\partial_j+c
  $$
  with $a_{ij}=a_{ji}$.  Moreover we will not use the usual Hölder norm
  $$
    \norm{u}_{\mathcal{C}^{k,\alpha}(\Omega)}=\sup_{\substack{x\ne y\\ \abs{\beta}=k}}\frac{\abs{\partial^\beta u(x)-\partial^\beta u(y)}}{\abs{x-y}^\alpha}
  $$
  but the following one:
  $$
    \norm{u}_{\mathcal{C}^{k,\alpha}(\overline\Omega)}=\sup_{\substack{x\in \overline\Omega\\ \abs{\beta}\leq k}}\abs{\partial^\beta u(x)}+\sup_{\substack{x\ne y\\ \abs{\beta}=k}}\frac{\abs{\partial^\beta u(x)-\partial^\beta u(y)}}{\abs{x-y}^\alpha}
  $$

  \begin{remark}
    Recall that $(\mathcal{C}^{k,\alpha}(\overline\Omega),\norm{\cdot}_{\mathcal{C}^{k,\alpha}(\overline\Omega)})$ is a Banach space and that if $0<\alpha_1\leq\alpha_2<1$, then $
      \mathcal{C}^{k,\alpha_2}(\overline{\Omega})\subseteq \mathcal{C}^{k,\alpha_1}(\overline{\Omega})$
  \end{remark}

  \subsubsection{Schauder estimates}
  \begin{theorem}[Schauder estimates]\label{INEPDE:schauder_estimates}
    Let $\Omega\subset \RR^d$ be open and bounded with $\Fr{\Omega}\in\mathcal{C}^{2,\alpha}$ for some $0<\alpha<1$. In the elliptic operator $L$ assume that $a_{ij},b_j,c\in\mathcal{C}^{0,\alpha}(\overline{\Omega})$. Then, $\exists C>0$ such that if $u\in\mathcal{C}^2(\Omega)\cap \mathcal{C}^0(\overline{\Omega})$ solves $Lu=f$, with $f\in\mathcal{C}^{0,\alpha}(\overline{\Omega})$, then $u\in \mathcal{C}^{2,\alpha}(\overline{\Omega})$ and:
    $$
      \norm{u}_{\mathcal{C}^{2,\alpha}(\overline{\Omega})}\leq C\left(\norm{f}_{\mathcal{C}^{0,\alpha}(\overline{\Omega})}+\norm{u}_{\mathcal{C}^{1,\alpha}(\overline{\Omega})}\right)
    $$
    Moreover we have:
    $$
      \norm{u}_{\mathcal{C}^{2,\alpha}(\overline{\Omega})}\leq \tilde{C}\left(\norm{f}_{\mathcal{C}^{0,\alpha}(\overline{\Omega})}+\norm{u}_{\mathcal{C}^{0}(\overline{\Omega})}\right)
    $$
  \end{theorem}
  \begin{corollary}
    Let $\Omega\subset \RR^d$ be open and bounded with $\Fr{\Omega}\in\mathcal{C}^{k+2,\alpha}$ for some $0<\alpha<1$ and $k\geq 0$. In the elliptic operator $L$ assume that $a_{ij},b_j,c\in\mathcal{C}^{k,\alpha}(\overline{\Omega})$. Then, $\exists c>0$ such that if $u\in\mathcal{C}^{k+2}(\Omega)\cap \mathcal{C}^k(\overline{\Omega})$ solves $Lu=f$, with $f\in\mathcal{C}^{k,\alpha}(\overline{\Omega})$, then $u\in \mathcal{C}^{k+2,\alpha}(\overline{\Omega})$ and:
    $$
      \norm{u}_{\mathcal{C}^{k+2,\alpha}(\overline{\Omega})}\leq C\left(\norm{f}_{\mathcal{C}^{k,\alpha}(\overline{\Omega})}+\norm{u}_{\mathcal{C}^{k+1,\alpha}(\overline{\Omega})}\right)
    $$
  \end{corollary}
  \subsubsection{Maximum and comparison principles}
  \begin{lemma}\label{INEPDE:lemma_matrices_max_principle}
    If $\vf{A},\vf{B}\in \mathcal{M}_d(\RR)$ are symmetric and $\vf{A}, \vf{B}\geq 0$, then $\tr(\vf{A}\vf{B})\geq 0$.
  \end{lemma}
  \begin{theorem}[Weak maximum principle]\label{INEPDE:weak_max_principle_nondiv}
    Let $u\in \mathcal{C}^2(\Omega)$ be such that $Lu\leq 0$. Then:
    \begin{itemize}
      \item If $c=0$, then $\displaystyle \max_{\overline{\Omega}}u=\max_{\Fr{\Omega}}u$.
      \item If $c\geq 0$, then $\displaystyle \max_{\overline{\Omega}}u\leq \max_{\Fr{\Omega}}u^+$.
    \end{itemize}
  \end{theorem}
  \begin{proof}
    Assume first that $Lu<0$ and $c=0$. Suppose $\exists x_0\in \Omega$ such that $u(x_0)=\max_{\overline{\Omega}}u$. Then, $\grad u(x_0)=0$ and $\vf{H}u(x_0)\leq0$, that is, $\sum_{i,j=1}^d\frac{\partial^2u}{\partial x_i\partial x_j}(x_0)p_ip_j\leq 0$ $\forall \vf{p}\in\RR^d$. On the other hand:
    \begin{align*}
      \trace(\vf{A}(x_0)\vf{H}u(x_0)) & = \sum_{i,j=1}^d a_{ij}(x_0)\frac{\partial^2u}{\partial x_i\partial x_j}(x_0) \\
                                      & =-Lu(x_0)>0
    \end{align*}
    The ellipticity of $L$ implies that $\vf{A}>0$, but this is a contradiction with \mcref{INEPDE:lemma_matrices_max_principle} because $\vf{H}u(x_0)\leq 0$. If we now have $c\geq 0$, assume that $\displaystyle \max_{\overline{\Omega}}u^+> \max_{\Fr{\Omega}}u^+$. Then, $\exists x_0\in \Omega$ such that $u(x_0)>0$ and $u(x_0)=\max_{\overline{\Omega}}u^+$. Similarly, we have:
    \begin{align*}
      \trace(\vf{A}(x_0)\vf{H}u(x_0)) & = \sum_{i,j=1}^d a_{ij}(x_0)\frac{\partial^2u}{\partial x_i\partial x_j}(x_0) \\
                                      & =-Lu(x_0) + c(x_0)u(x_0)\geq 0
    \end{align*}
    which again leads to a contraction. Now assume $Lu\leq 0$. Take $u_\varepsilon=u+\varepsilon \exp{\lambda x_1}$, with $\varepsilon>0$ and $\lambda>0$ yet to be chosen. An easy computation shows that:
    \begin{align*}
      Lu_\varepsilon & \leq \exp{\lambda x_1}[-\lambda^2a_{11}+b_1\lambda+c]                    \\
                     & \leq \exp{\lambda x_1}[-\lambda^2a_{11}+\norm{\vf{b}}_\infty\lambda+c]<0
    \end{align*}
    for $\lambda$ large enough. We do here the case $c=0$ (the other is analogous). From what we have previously seen, $\exists y_\varepsilon\in\Fr{\Omega}$ such that $u(x)\leq u_\varepsilon(x)\leq u_\varepsilon(y_\varepsilon)$. And so we can find a sequence $y_{\varepsilon_n}$ that converges to some $y_0\in\Fr{\Omega}$ (because $\Fr{\Omega}$ is compact) as $\varepsilon_n\to 0$, which implies $u(x)\leq u(y_0)$.
  \end{proof}
  \begin{theorem}[Weak minimum principle]
    Let $u\in \mathcal{C}^2(\Omega)$ be such that $Lu\geq 0$. Then:
    \begin{itemize}
      \item If $c=0$, then $\displaystyle \min_{\overline{\Omega}}u=\min_{\Fr{\Omega}}u$.
      \item If $c\geq 0$, then $\displaystyle \min_{\overline{\Omega}} u \geq -\max_{\Fr{\Omega}}u^-$.
    \end{itemize}
  \end{theorem}
  \begin{sproof}
    Apply \mnameref{INEPDE:weak_max_principle_nondiv} to $-u$ using that ${(-u)}^+=u^-$.
  \end{sproof}
  \begin{remark}
    Nothing can be said if $c<0$. For example, consider $-u''-u=0$, which has $u(x)=\sin(x)$ as a solution, and take $\Omega=(0,\pi)$.
  \end{remark}
  \begin{lemma}[Hopf's lemma]\label{INEPDE:Hopf}
    Let $u\in \mathcal{C}^2(\Omega)$ be such that $Lu\leq 0$ and suppose that the region $\Omega$ is connected and that satisfies the \emph{interior ball condition}: for any $x\in \Fr{\Omega}$ there exists $r>0$ and $y\in \Omega$ such that $B(y,r)\subset \Omega$ and $\overline{B(y,r)}\cap \Fr{\Omega}=\{x\}$. Suppose in addition that $c=0$ and $x_0\in\Fr\Omega$ is such that $\displaystyle u(x_0)=\max_{\overline{\Omega}}u$. Then, either $u$ is constant in $\Omega$ or
    $$
      \liminf_{t\to 0^+}\frac{u(x_0) - u(x_0+t\vf{n})}{t}>0
    $$
    for any vector $\vf{n}$ of the form $\vf{n}=\frac{x_0-y_0}{\norm{x_0-y_0}}$ with $B(y_0,r)\subset \Omega$ and $\overline{B(y_0,r)}\cap \Fr{\Omega}=\{x_0\}$.
  \end{lemma}
  \begin{remark}
    In particular, if $\Fr\Omega\in\mathcal{C}^1$ and $u\in \mathcal{C}^1(\overline{\Omega})$, then \mnameref{INEPDE:Hopf} implies that either $u$ is constant in $\Omega$ or $\partial_{\vf{n}}u(x_0)=\grad u(x_0)\cdot \vf{n}>0$.
  \end{remark}
  \begin{theorem}[Strong maximum principle]\label{INEPDE:strong_max_principle}
    Let $\Omega\subset\RR^d$ be open, bounded and connected, and $u\in \mathcal{C}^2(\Omega)$ be such that $Lu\leq 0$. Then:
    \begin{enumerate}
      \item If $c=0$ and $\exists x_0\in\Omega$ such that $u(x_0)\geq u(x)$ $\forall x\in\Omega$, then $u=\const$ in $\Omega$.
      \item If $c\geq 0$ and $\exists x_0\in\Omega$ such that $u(x_0)\geq 0$ and $u(x_0)\geq u(x)$ $\forall x\in\Omega$, then $u=\const$ in $\Omega$.
    \end{enumerate}
  \end{theorem}
  \begin{proof}
    Assume $c=0$, the other case is similar. Let $\displaystyle M=\max_{\overline{\Omega}}u$, $C:= \{u=M\}$ and $V:=\{u<M\}$. Take $y\in V$ satisfying $d(y,C)<d(y,\Fr{\Omega})$ and let $B$ be the largest ball with center at $y$ whose interior lies in $V$. Then, there exists $x_0\in C$ with $x_0\in \Fr{B}$. Clearly $V$ satisfies the interior ball condition at $x_0$, whence \mnameref{INEPDE:Hopf} implies that $\partial_{\vf{n}}u(x_0)>0$. But $\partial_{\vf{n}}u(x_0)=0$ because $x_0\in C$, which is a contradiction. Thus, $V=\varnothing$ and so $u=\const$ in $\Omega$.
  \end{proof}
  \begin{theorem}[Strong minimum principle]\label{INEPDE:strong_min_principle}
    Let $\Omega\subset\RR^d$ be open, bounded and connected, and $u\in \mathcal{C}^2(\Omega)$ be such that $Lu\geq 0$. Then:
    \begin{enumerate}
      \item If $c=0$ and $\exists x_0\in\Omega$ such that $u(x_0)\leq u(x)$ $\forall x\in\Omega$, then $u=\const$ in $\Omega$.
      \item If $c\geq 0$ and $\exists x_0\in\Omega$ such that $u(x_0)\leq 0$ and $u(x_0)\leq u(x)$ $\forall x\in\Omega$, then $u=\const$ in $\Omega$.
    \end{enumerate}
  \end{theorem}
  \begin{sproof}
    Apply \mnameref{INEPDE:strong_max_principle} to $-u$.
  \end{sproof}
  \begin{theorem}[A priori estimate]\label{INEPDE:apriori}
    Suppose that $c\geq 0$ and $u\in \mathcal{C}^2(\Omega)$ is a solution of
    $$
      \begin{cases}
        Lu=f               & \text{in }\Omega      \\
        u|_{\Fr{\Omega}}=h & \text{on }\Fr{\Omega}
      \end{cases}
    $$
    with $f\in \mathcal{C}^0(\overline{\Omega})$ and $h\in \mathcal{C}^0(\Fr{\Omega})$. Then, $\forall x\in\overline{\Omega}$:
    $$
      u(x)\leq \max_{\Fr{\Omega}}h^++C\max_{\overline{\Omega}}f^+
    $$
    with $C$ independent of $u$, $f$ and $h$. Moreover, we have:
    $$
      \abs{u}\leq \max_{\Fr{\Omega}}\abs{h}+C\max_{\overline{\Omega}}\abs{f}
    $$
  \end{theorem}
  \begin{proof}
    Let $$w(x)=\displaystyle \max_{\Fr{\Omega}}h^++\max_{\overline{\Omega}}f^+(\cosh(\lambda r)-\cosh(\lambda x_1))$$
    with $r=\max\{\abs{x_1}:x\in\overline{\Omega}\}$. An easy check shows that for $\lambda=\lambda_0>0$ large enough we have:
    $$
      \begin{cases}
        Lw \geq \displaystyle\max_{\overline{\Omega}}f^+ \\
        \displaystyle\max_{\Fr{\Omega}}h^+\leq w \leq \displaystyle\max_{\Fr{\Omega}}h^++\max_{\overline{\Omega}}f^+ \cosh(\lambda_0 r)
      \end{cases}
    $$
    Let $v=u-w$. Then, $Lv\leq 0$ and $v|_{\Fr{\Omega}}\leq 0$. Thus, \mnameref{INEPDE:weak_max_principle_nondiv} implies that $v\leq 0$ in $\Omega$, that is, $u\leq w$ in $\Omega$.
  \end{proof}
  \subsubsection{Continuation method}
  \begin{theorem}[Continuation method]
    Let $\Omega\subset\RR^d$ be open and bounded with $\Fr{\Omega}\in\mathcal{C}^{2,\alpha}$ for some $0<\alpha<1$. Consider the problem:
    $$
      \begin{cases}
        Lu=f               & \text{in }\Omega      \\
        u|_{\Fr{\Omega}}=h & \text{on }\Fr{\Omega}
      \end{cases}
    $$
    with $f,a_{ij},b_j,c\in\mathcal{C}^{0,\alpha}( \overline{\Omega})$ and $h\in\mathcal{C}^{0,\alpha}(\Fr{\Omega})$. Then, there exists a solution to this problem in $\mathcal{C}^{2,\alpha}(\overline{\Omega})$.
  \end{theorem}
  \begin{proof}
    We will do it for $h=0$.
    Let $t\in [0,1]$ and consider the problem:
    $$ \mathcal{D}_t:= \begin{cases}
        L_tu=f             & \text{in }\Omega      \\
        u|_{\Fr{\Omega}}=0 & \text{on }\Fr{\Omega}
      \end{cases}$$
    with $L_t=tL-(1-t)\laplacian$. We know that $\mathcal{D}_0$ has a unique weak solution $u_0\in H_0^1(\Omega)$. The idea of the continuation method is that if $\mathcal{D}_t$ is solvable for all $f$, then for $k>0$ small enough, $\mathcal{D}_{t+k}$ is solvable for all $f$ too. Rewrite $\mathcal{D}_{t+k}$ as:
    $$
      \begin{cases}
        L_{t}u=f-k(L+\laplacian)u & \text{in }\Omega      \\
        u|_{\Fr{\Omega}}=0        & \text{on }\Fr{\Omega}
      \end{cases}
    $$
    We need to solve the fixed point problem $u=\phi(u)$, with
    $$
      \function{\phi}{\mathcal{C}^{2,\alpha}}{\mathcal{C}^{2,\alpha}}{u}{\phi(u)={L_t}^{-1}f - k{L_t}^{-1}(L+\laplacian)u}
    $$
    From \mnameref{INEPDE:schauder_estimates} and \mnameref{INEPDE:apriori} we deduce that $\norm{u}_{\mathcal{C}^{2,\alpha}(\overline{\Omega})}\leq C\norm{f}_{\mathcal{C}^{0,\alpha}(\overline{\Omega})}$. So $\forall \varphi\in \mathcal{C}^{0,\alpha}(\overline{\Omega})$ we have $\norm{{L_t}^{-1}\varphi}_{\mathcal{C}^{2,\alpha}(\overline{\Omega})}\leq C\norm{\varphi}_{\mathcal{C}^{0,\alpha}(\overline{\Omega})}$ (it can be seen that the constant does not depend on $t$). We will show that $\phi$ is a contraction for $k$ small enough. Let $u,v\in \mathcal{C}^{2,\alpha}(\overline{\Omega})$. Then:
    \begin{align*}
      \norm{\phi(u)-\phi(v)}_{\mathcal{C}^{2,\alpha}(\overline{\Omega})} & \leq Ck\norm{(L+\laplacian)(u-v)}_{\mathcal{C}^{0,\alpha}(\overline{\Omega})} \\
                                                                         & \leq \tilde{C}k\norm{u-v}_{\mathcal{C}^{2,\alpha}(\overline{\Omega})}
    \end{align*}
    So take $k\leq \frac{1}{2\tilde{C}}$. Repeating this argument a finite number of times ($\tilde{C}$ does not depend on $t$) we conclude that $\mathcal{D}_1$ is solvable.
  \end{proof}
  \subsection{Existence theorems for nonlinear elliptic PDEs by fixed point methods}
  In this section we will mostly consider almost linear elliptic PDEs of the form:
  \begin{equation}\label{INEPDE:AlmostLinear}
    \begin{cases}
      Lu=f(x,u) \\
      u|_{\Fr{\Omega}}=0
    \end{cases}
  \end{equation}
  with $L$ either $-\sum_{i,j=1}^d\partial_i(a_{ij}\partial_j)+\sum_{j=1}^db_j\partial_j$ or $-\sum_{i,j=1}^d a_{ij} \partial_{ij}^2+\sum_{j=1}^db_j\partial_j$, and $f:\Omega\times \RR\to \RR$.
  \subsubsection{Method of subsoltions and supersolutions}
  \begin{theorem}
    Suppose that an operator $L$ is uniformly elliptic on an open bounded set $\Omega\subset\RR^d$ with $\Fr{\Omega}\in \mathcal{C}^2$, with $c=0$ and either in divergence form (with $a_{ij}\in\mathcal{C}^1$) or non-divergence form (with $a_{ij},b_j\in\mathcal{C}^{0,\alpha}$). Suppose that $f\in\mathcal{C}^1(\overline{\Omega}\times \RR)$ and assume that the problem of \mcref{INEPDE:AlmostLinear} has a bounded subsolution $\underline{u}$ and a bounded supersolution $\overline{u}$ such that $\underline{u}\leq \overline{u}$. Then, there exists a solution $u$ to \mcref{INEPDE:AlmostLinear} such that $\underline{u}\leq u\leq \overline{u}$, which is in $H_0^1(\Omega)\cap H_0^2(\Omega)$ if $L$ is in divergence form and in $\mathcal{C}^{2,\alpha}(\overline{\Omega})$ if $L$ is in non-divergence form.
  \end{theorem}
  \begin{proof}
    Let $M:=\max\{\norm{\underline{u}}_\infty,\norm{\overline{u}}_\infty\}$ and modify $f$ outside the set $\overline{\Omega}\times [-M,M]$ so that the modified function $\tilde{f}$ is globally Lipschitz in $u$ and $\displaystyle\sup_{\overline{\Omega}\times \RR}\abs{\frac{\tilde{f}}{u}}\leq \sup_{\overline{\Omega}\times [-M-2,M+2]}\abs{\frac{f}{u}}+1=:k$. Then, the function $g(x,t)=\tilde{f}(x,t)+kt$ is non-decreasing in $t$, and we can rewrite the problem as:
    $$
      \begin{cases}
        (L+k)u=g(x,u)      & \text{in }\Omega      \\
        u|_{\Fr{\Omega}}=0 & \text{on }\Fr{\Omega}
      \end{cases}
    $$
    Now we construct a sequence of functions $\{u_n\}_{n\in\NN}$ as follows. Let $u_0=\underline{u}$ and $\forall n\in\NN\cup\{0\}$, $u_{n+1}$ be the solution of:
    $$
      \begin{cases}
        (L+k)u=g(x,u_n)    & \text{in }\Omega      \\
        u|_{\Fr{\Omega}}=0 & \text{on }\Fr{\Omega}
      \end{cases}
    $$
    Take $w=u_{n}-u_{n+1}$. By induction, using the monotonicity of $g$ we have that $w$ solves:
    $$
      \begin{cases}
        (L+k)w\leq 0           & \text{in }\Omega      \\
        w|_{\Fr{\Omega}}\leq 0 & \text{on }\Fr{\Omega}
      \end{cases}
    $$
    So by the \mnameref{INEPDE:weak_max_principle_nondiv} we have that $w\leq 0$ in $\Omega$. Similarly, taking $v=u_{n+1}-\overline{u}$ we have that $v$ solves the same problem, so $v\leq 0$ in $\Omega$. Summarizing, one can check we have $\underline{u}\leq u_n\leq u_{n+1}\leq \overline{u}$ for all $n\in\NN$. So $\displaystyle\exists u(x):=\lim_{n\to\infty}u_n(x)$, which is a solution to the problem. It suffices to see that $u_n\overset{\mathcal{C}^{0,\alpha}}{\longrightarrow} u$ because then we'd have $g(x,u_n) \overset{\mathcal{C}^{0,\alpha}}{\longrightarrow} g(x,u)$ and so $u_{n+1}= (L+k)^{-1}g(x,u_n) \overset{\mathcal{C}^{2,\alpha}}{\longrightarrow} (L+k)^{-1}g(x,u)=u$. But this is clear because $u_n\overset{W^{1,p}}{\longrightarrow} u$ (because of the compact embedding $W^{2,p}\subset W^{1,p}$) for all $p<\infty$, and we have an embedding $W^{1,p}(\Omega)\subset \mathcal{C}^{0,\theta}(\overline{\Omega})$ for $p>d$ and for some particular $\theta=1-\frac{d}{p}$ (see \mnameref{ATFAPDE:morrey_embedding}). Now given $\theta=\alpha$ choose $p$ according that relation.
  \end{proof}
  \subsubsection{Topological fixed point theorems}
  \begin{theorem}[Brower fixed point]\label{INEPDE:Brower}
    Let $C\subset \RR^n$ be a closed convex bounded set and $f:C\to C$ be a continuous function. Then, $f$ has at least a fixed point.
  \end{theorem}
  \begin{theorem}[Schauder fixed point]\label{INEPDE:schauder_fixed_point}
    Let $C$ be a convex set in a Banach space $(E,\norm{\cdot})$ and $f:C\to C$ be a continuous function. Assume one of the following two assumptions:
    \begin{itemize}
      \item $C$ is compact for $\norm{\cdot}$.
      \item $C$ is closed and bounded and $f$ is compact.
    \end{itemize}
    Then, $f$ has at least a fixed point.
  \end{theorem}
  \begin{proof}
    We will prove it in a Hilbert space $(E,\norm{\cdot})$. Assume the first assumption. Let $\varepsilon>0$. Then, by compactness $\exists N_\varepsilon\in\NN$ and $x_1^\varepsilon,\dots,x_{N_\varepsilon}^\varepsilon\in C$ such that $C\subset \bigcup_{i=1}^{N_\varepsilon}B(x_i^\varepsilon,\varepsilon)$. Let $V_\varepsilon=\langle x_1^\varepsilon,\dots,x_{N_\varepsilon}^\varepsilon\rangle$ be the linear span of these vectors and $C_\varepsilon:=V_\varepsilon\cap C$. Then, $\forall x\in C$ $d(x,C_\varepsilon)< \varepsilon$ because $d(x,x_j^\varepsilon)<\varepsilon$ for some $j$ and $x_j^\varepsilon\in C_\varepsilon$. Let $p_\varepsilon:E\to C_\varepsilon$ be the nonlinear projection on the closed convex bounded set $C_\varepsilon$. For all $x\in C$ we have $\norm{x-p_\varepsilon(x)}\leq d(x,C_\varepsilon)<\varepsilon$. Now define $f_\varepsilon:C_\varepsilon\to C_\varepsilon$ by $f_\varepsilon(x)=p_\varepsilon(f(x))$. Then, $f_\varepsilon$ is continuous and by \mnameref{INEPDE:Brower} we have that $f_\varepsilon$ has a fixed point $x_\varepsilon\in C_\varepsilon$. Thus:
    $$
      \norm{f(x_\varepsilon)-x_\varepsilon}=\norm{f(x_\varepsilon)-p_\varepsilon(f(x_\varepsilon))}<\varepsilon
    $$
    By compactness, there is a sequence $\varepsilon_n\to 0$ and $x\in C$ such that $\norm{x_{\varepsilon_n}-x}\to 0$. By the continuity of $f$, $x$ is a fixed point of $f$.

    Now assume the second hypothesis. Let $K=\overline{\Conv(f(C))}$ be the closure of the \emph{convex hull} of $f(C)$, that is the smallest convex set containing $f(C)$. Then, $K$ is compact and convex. Moreover, $K\subseteq C$ since $f(C)\subseteq C$, $C$ is convex and closed. Furthermore, $f(K)\subseteq f(C)\subseteq K$. So $f$ restricts to a continuous function $f|_K:K\to K$. By the first assumption, $f|_K$ has a fixed point $x\in K\subseteq C$.
  \end{proof}
  \begin{theorem}[Schaefer fixed point]\label{INEPDE:schaefer_fixed_point}
    Let $(E, \norm{\cdot})$ be Banach and $f:E\to E$ be continuous and compact. Suppose that $\exists M>0$ such that $\forall (\lambda,u)\in [0,1]\times E$ with $u=\lambda f(u)$ we have $\norm{u}<M$. Then, $f$ has at least a fixed point, that lies in $\overline{B(0,M)}$.
  \end{theorem}
  \begin{proof}
    Take $C=\overline{B(0,M)}$. For $x\in C$, let:
    $$
      \tilde{f}(x):=\begin{cases}
        f(x)                      & \text{if }x\in C        \\
        M\frac{f(x)}{\norm{f(x)}} & \text{if }\norm{f(x)}>M
      \end{cases}
    $$
    An easy check shows that $f:C\to C$ is continuous and compact. So, by \mnameref{INEPDE:schauder_fixed_point} $\exists x_*\in C$ such that $x_*=\tilde{f}(x_*)$. If $\norm{x_*}=\norm{f(x_*)}> M$, then:
    $$
      \norm{x_*}=M\frac{\norm{f(x_*)}}{\norm{f(x_*)}}=M
    $$
    which is absurd. So $f(x_*)=x_*$.
  \end{proof}
  \subsection{Variational methods for nonlinear elliptic PDEs}
  In this section we will solve a PDE $Lu=f(x,u,\grad u)$ by minimizing a certain functional under some constraints.
  \subsubsection{Linear case}
  \begin{proposition}[Without constraints]
    Consider the problem:
    \begin{equation}\label{INEPDE:var_linear_problem}
      \begin{cases}
        Lu:=-\sum_{i,j=1}^d \partial_i(a_{ij}\partial_j u)+cu=f \\
        u|_{\Fr{\Omega}}=0
      \end{cases}
    \end{equation}
    with $L$ elliptic, $a_{ij},c\in L^\infty(\Omega)$ with $a_{ij}= a_{ji}$, $c\geq 0$, and $f\in L^2(\Omega)$. Then, the problem has a unique weak solution $u\in H_0^1(\Omega)$, and it minimizes the functional:
    $$
      I(u)=\frac{1}{2}\beta(u,u)-\int_\Omega fu
    $$
    where $\displaystyle\beta(u,v)=\sum_{i,j=1}^d\int_\Omega a_{ij}\partial_i u\partial_j v + \int_\Omega cuv$.
  \end{proposition}
  \begin{proof}
    By \mnameref{RFA:riesz_rep} (using the scalar product $\beta$, which is positive definite because $c\geq 0$) we have that this problem has a unique weak solution $u_f\in H_0^1(\Omega)$. Moreover, it minimizes the functional $I$. Indeed, we have:
    \begin{multline*}
      I(u)-I(u_f)=\beta(u_f,u-u_f)-\int f(u-u_f)+\\
      +\frac{1}{2}\beta(u-u_f,u-u_f)= \frac{1}{2} \beta(u-u_f,u-u_f)>0
    \end{multline*}
    if $u\ne u_f$.
  \end{proof}
  \begin{lemma}\label{INEPDE:optimization}
    Let $X$ be a Banach space and $\Phi:X\to \RR$ be continuous and convex, then it is weakly sequentially lower semicontinuous, that is, if $u_n\rightharpoonup u$ in $X$, then $\displaystyle\Phi(u)\leq \liminf_{n\to\infty}\Phi(u_n)$.
  \end{lemma}
  \begin{theorem}
    Let $(X,\norm{\cdot})$ be a reflexive Banach space and $\Phi:X\to \RR$ be continuous, convex and such that $\displaystyle \lim_{\norm{u}\to\infty}\Phi(u)=+\infty$. Then, $\Phi$ has a minimizer. This minimizer is unique if $\Phi$ is strictly convex.
  \end{theorem}
  \begin{proof}
    Let $\{u_n\}_{n\in\NN}\subset X$ be a minimizing sequence. Then, $\displaystyle\sup_{n\in\NN}\Phi(u_n)<\infty$, so by the coercivity property of $\Phi$ we have that $\{u_n\}_{n\in\NN}$ is bounded, and so $\{u_n\}_{n\in\NN}$ has a weakly convergent subsequence $\{u_{n_k}\}_{k\in\NN}$ with limit $u\in X$. By \mcref{INEPDE:optimization} we have:
    $$
      \Phi(u)\leq \lim_{k\to\infty}\Phi(u_{n_k})=\inf_{u\in X}\Phi(u)
    $$
    But $\displaystyle\Phi(u)\geq \inf_{u\in X}\Phi(u)$, so $u$ is a minimizer.
  \end{proof}
  \begin{theorem}[With constraints]
    Consider the problem of \mcref{INEPDE:var_linear_problem}. We know that $L$ is invertible with inverse $L^{-1}:L^2(\Omega)\to H_0^1(\Omega)$. But $H_0^1(\Omega)$ is compactly embedded into $L^2(\Omega)$ (see \mnameref{ATFAPDE:reillich_kondrachov_compactness}), so:
    $$
      \function{K}{L^2(\Omega)}{L^2(\Omega)}{f}{L^{-1}f}
    $$
    is compact. Thus, a Hilbert basis $(u_n)$ of $K$ with $Ku_n=\mu_n u_n$, $\mu_n>0$ with $\mu_n\to 0$ as $n\to\infty$ exists (we may assume $\mu_n\searrow 0$). Thus, $Lu_n=\lambda_nu_n$ with $\lambda_n=\frac{1}{\mu_n}\nearrow+\infty$. Then:
    $$
      \lambda_1=\!\!\min_{\substack{u\in H_0^1(\Omega) \\ \norm{u}_{L^2(\Omega)}=1}}\!\!{\langle Lu,u\rangle}_{H^{-1}\times H_0^1}=\!\!\min_{u\in H_0^1(\Omega)\setminus\{0\}}\!\!\frac{{\langle Lu,u\rangle}_{H^{-1}\times H_0^1}}{\norm{u}_{L^2(\Omega)}^2}
    $$
    And:
    \begin{align*}
      \lambda_k & =\min_{\substack{u\in H_0^1(\Omega)                   \\u\in\langle u_1,\dots,u_{k-1}\rangle^{\perp_{L^2}}\\ \norm{u}_{L^2(\Omega)}=1}}{\langle Lu,u\rangle}_{H^{-1}\times H_0^1}\\
                & = \min_{\substack{u\in H_0^1(\Omega)\setminus\{0\}    \\ u\in\langle u_1,\dots,u_{k-1}\rangle^{\perp_{L^2}}}}\frac{{\langle Lu,u\rangle}_{H^{-1}\times H_0^1}}{\norm{u}_{L^2(\Omega)}^2}\\
                & =\min_{\substack{V\text{ subspace of }H_0^1(\Omega)   \\ \dim(V)=k}}\max_{\substack{u\in V\setminus\{0\} \\ \norm{u}_{L^2(\Omega)}=1}}{\langle Lu,u\rangle}_{H^{-1}\times H_0^1}\\
                & = \max_{\substack{W\text{ subspace of } H_0^1(\Omega) \\ \codim(W)=k-1}}\min_{\substack{u\in W\setminus\{0\} \\ \norm{u}_{L^2(\Omega)}=1}}{\langle Lu,u\rangle}_{H^{-1}\times H_0^1}
    \end{align*}
  \end{theorem}
  \begin{proof}
    We only prove some of them.
    Recall that $H_0^1=\overline{\bigoplus_{n\in\NN} \langle u_n\rangle}^{{}_{H_0^1}}$ and $L^2=\overline{\bigoplus_{n\in\NN} \langle u_n\rangle}^{{}_{L^2}}$. Take $u\in H_0^1(\Omega)\setminus\{0\}$ and write $u=\sum_{n\in\NN}\alpha_n u_n$, which converges in both $L^2$ and $H_0^1$. We have:
    $$
      {\langle Lu,u\rangle}_{H^{-1}\times H_0^1}= \sum_{n\in\NN}\lambda_n{\alpha_n}^2\geq \lambda_1\sum_{n\in\NN}{\alpha_n}^2=\lambda_1\norm{u}_{L^2(\Omega)}^2
    $$
    So the first equality holds since the lower bound is attained by $u=u_1$. Now take $u\perp_{L^2}\langle u_1,\dots,u_{k-1}\rangle$. Then, $\alpha_1=\dots=\alpha_{k-1}=0$ and so:
    $$
      {\langle Lu,u\rangle}_{H^{-1}\times H_0^1}= \sum_{n\geq n}\lambda_n{\alpha_n}^2\geq \lambda_n\sum_{n\geq n}{\alpha_n}^2=\lambda_n\norm{u}_{L^2(\Omega)}^2
    $$
    So the third equality holds since the lower bound is attained by $u=u_k$.
  \end{proof}
  \subsubsection{Nonlinear case without constraints}
  \begin{definition}
    We say that $f:\Omega\times \RR\to\RR$ is \emph{Carathéodory} if $f$ is measurable in $x$ and continuous in $t$.
  \end{definition}
  \begin{theorem}[Superposition operator]
    Let $f:\Omega\times \RR\to\RR$ be Carathéodory satisfying the growth condition $\abs{f(x,t)}\leq C(1+\abs{t}^\theta)$ $\forall (x,t)\in \Omega\times \RR$ with $\theta\geq 1$. Then, for any $\theta\leq p<\infty$, the \emph{superposition operator}
    $$
      \function{\Phi_f}{L^p(\Omega)}{L^{p/\theta}(\Omega)}{u}{f(\cdot,u(\cdot))}
    $$
    is continuous.
  \end{theorem}
  \begin{proof}
    Let $(u_n),u\in L^p(\Omega)$ be such $u_n\overset{L^p}{\longrightarrow} u$. We will prove that $v_n:=f(\cdot,u_n(\cdot))$ is precompact in $L^{p/\theta}(\Omega)$ (that is, any subsequence $v_{n_k}$ has a convergent subsequence) and has only one limit point, which is $v:=f(\cdot,u(\cdot))$. Take a subsequence $(v_{n_k})$ of $(v_n)$. We know that $u_{n_k}\overset{L^p}{\longrightarrow} u$. We know that in this case there exists a subsequence $u_{n_{k_j}}\almoste{\to }u$ and $\abs{u_{n_{k_j}}}\leq h$ with $h\in L^p$. Then, by the continuity of $f$, $v_{n_{k_j}}\almoste{\to} v$ and by the growth condition, $v_{n_{k_j}}\leq C(1+\abs{h(x)}^\theta)\in L^{p/\theta}$. So, by \mnameref{RFA:dominated}, $v_{n_{k_j}}\overset{L^{p/\theta}}{\longrightarrow} v$.
  \end{proof}
  \begin{proposition}\label{INEPDE:minimization_prop1}
    Let $f:\Omega\times \RR\to\RR$ be Carathéodory satisfying the growth condition $\abs{f(x,t)}\leq C(1+\abs{t}^\theta)$ $\forall (x,t)\in \Omega\times \RR$ with $1\leq \theta\leq 2^*$, $\frac{1}{2^*}=\frac{1}{2}-\frac{1}{d}$, (if $d\geq 3$) and $1\leq \theta<\infty$ (if $d=2$). Then, the superposition operator
    $$
      \function{\Phi_f}{H^1(\Omega)}{L^{p/\theta}(\Omega)}{u}{f(\cdot,u(\cdot))}
    $$
    is continuous for all $\theta \leq p\leq 2^*$ (if $d\geq 3$) and $\theta\leq p<\infty$ (if $d=2$). Moreover, $\Phi_f$ is compact if $\theta<p<2^*$ (if $d\geq 3$) or $\theta<p<\infty$ (if $d=2$).
  \end{proposition}
  \begin{definition}
    Let $X,Y$ be normed spaces and $T:X\to Y$. We say that $T$ is \emph{Fréchet differentiable} at $u\in X$ if $\exists L\in \mathcal{L}(X,Y)$ such that:
    $$
      \lim_{\substack{h\to 0\\h\in X\setminus\{0\}}}\frac{\norm{T(u+h)-T(u)-Lh}}{\norm{h}}=0
    $$
    In this case, we say that $L$ is the \emph{Fréchet derivative} of $T$ at $u$. We denote it by $\dd{T(u)}$.
  \end{definition}
  \begin{definition}
    Let $X,Y$ be normed spaces and $T:X\to Y$. We say that $T$ is \emph{Gâteaux differentiable} at $u\in X$ if $\exists L\in \mathcal{L}(X,Y)$ such that $\forall h\in X$:
    $$
      \lim_{\substack{t\to 0\\t\ne 0}}\frac{T(u+th)-T(u)}{t}=Lh
    $$
    In this case, we say that $L$ is the \emph{Gâteaux derivative} of $T$ at $u$. We denote it by $D{T}(u)$.
  \end{definition}
  \begin{lemma}
    Let $X,Y$ be normed spaces and $T:X\to Y$. Then, if the Fréchet and Gâteaux derivatives of $T$ at $u$ exist, they are unique. Moreover we have:
    \begin{itemize}
      \item If $T$ is Fŕechet differentiable at $u$, then it is Gâteaux differentiable at $u$ and both differentials coincide.
      \item If $T$ is Fréchet differentiable at $u$, $T$ is continuous at $u$.
      \item If $T$ is Gâteaux differentiable at $u\in U$ and the map
            $$
              \function{}{U}{\mathcal{L}(X,Y)}{u}{DT(u)}
            $$
            is continuous, then $T$ is Fréchet differentiable at $u$ and $\dd{T(u)}=DT(u)$.
    \end{itemize}
  \end{lemma}
  \begin{proposition}\label{INEPDE:minimization_prop2}
    Let $f:\Omega\times \RR\to\RR$ be Carathéodory satisfying the growth condition $\abs{f(x,t)}\leq C(1+\abs{t}^\theta)$ $\forall (x,t)\in \Omega\times \RR$ with $1\leq \theta\leq \frac{d+2}{d-2}$ (if $d\geq 3$) and $1\leq \theta<\infty$ (if $d=2$). Let $F(x,t):=\int_0^tf(x,s)\dd{s}$ and consider the functional
    $$
      \function{\Psi}{H^1(\Omega)}{\RR}{u}{\displaystyle\int_\Omega F(x,u(x))\dd{x}}
    $$
    Then, $\Psi$ is well-defined on $H^1$, it is of class $\mathcal{C}^1$ and its differential is given by:
    $$
      \dd{\Psi(u)}h=\int_\Omega f(x,u(x))h(x)\dd{x}
    $$
  \end{proposition}
  \begin{proof}
    We will assume $d\geq 3$, the case $d=2$ is similar. We have that $\abs{F(x,t)}\leq \tilde{C}(1+\abs{t}^{\theta+1})$. Note that $2\leq \theta+1\leq 2^*$, so taking $p=\theta+1$ in \mcref{INEPDE:minimization_prop1} we have that
    $$
      \function{\Phi_F}{H^1(\Omega)}{L^{1}(\Omega)}{u}{\int_0^{u}f(x,s)\dd{s}}
    $$
    is continuous. Thus, $\Psi$ is well-defined and continuous. Let $h\in H^1(\Omega)$, $t\in (-1,1)$ and consider $g(t)=\Psi(u+th)$. We have:
    \begin{align*}
      \abs{\pdv{}{t}F(x,u+th)} & =\abs{f(x,u+th)h(x)}                                      \\
                               & \leq C\left(1+{(\abs{u}+\abs{h})}^\theta\right)\abs{h}=:H
    \end{align*}
    By \mcref{INEPDE:minimization_prop1}, we know that ${(\abs{u}+\abs{h})}^\theta\in L^{2^*/\theta}$ and $\abs{h}\in L^{2^*}$, so by \mnameref{RFA:holder} (since $\frac{1}{2^*}+\frac{\theta}{2^*}=\frac{\theta+1}{2^*}\leq 1$) we have that $H\in L^1(\Omega)$. Thus, by \mcref{RFA:diffUnderIntegralSign} we have that $g$ is differentiable and:
    $$
      g'(0)=\int_\Omega f(x,u(x))h(x)\dd{x}
    $$
    So $\exists D\Psi(u)$ and $$
      D\Psi(u)h=\int_\Omega f(x,u(x))h(x)\dd{x}={\langle \Phi_f(u), h\rangle}_{L^{p'}\times L^p}
    $$
    where $\frac{1}{p}+\frac{1}{p'}=1$ and $2\leq p\leq 2^*$. To prove that $\Psi\in\mathcal{C}^1$, it suffices to show that $\Phi_f\in \mathcal{C}(H^1,L^{p'})$. We have $f(x,t)\leq C(1+\abs{t}^\theta)$, so $\Phi_f:H^1\to L^{p/\theta}$ is continuous for $\frac{d+2}{d-2}\leq p\leq 2^*$. If $p'\leq p/\theta$, since $\Omega$ is bounded, $L^{p/\theta}\hookrightarrow L^{p'}$ is continuous by \mnameref{RFA:holder}. An easy check shows that if we take $p=2^*$, and $p'$ such that $\frac{1}{p}+\frac{1}{p'}=1$, these inequality hold.
  \end{proof}
  \begin{theorem}[Without constraints]
    Let $f:\Omega\times \RR\to\RR$ be Carathéodory satisfying
    \begin{itemize}
      \item $\abs{f(x,t)}\leq C(1+\abs{t}^\theta)$ $\forall (x,t)\in \Omega\times \RR$ with $1\leq \theta\leq \frac{d+2}{d-2}$ (if $d\geq 3$) and $1\leq \theta<\infty$ (if $d=2$).
      \item $f(x,t)\sign(t)\leq C'$ $\forall (x,t)\in \Omega\times \RR$.
    \end{itemize}
    Let $F(x,t):=\int_0^tf(x,s)\dd{s}$ and for $u\in H_0^1(\Omega)$ consider the functional:
    $$
      I(u)=\frac{1}{2}\int_\Omega \abs{\grad u}^2-\int_\Omega F(x,u)\dd{x}
    $$
    Then, $I\in\mathcal{C}^1(H_0^1,\RR)$, it is bounded from below and there is $\underline{u}\in H_0^1(\Omega)$ such that $\displaystyle I(\underline{u})=\min_{u\in H_0^1(\Omega)}I(u)$. Moreover, $\underline{u}$ is a weak solution to the problem:
    \begin{equation}
      \label{INEPDE:eq_problem_min}
      \begin{cases}
        -\laplacian u=f(x,u) & \text{in }\Omega      \\
        u|_{\Fr{\Omega}}=0   & \text{on }\Fr{\Omega}
      \end{cases}
    \end{equation}
  \end{theorem}
  \begin{proof}
    We saw in \mcref{INEPDE:minimization_prop2} that the map $u\mapsto \int_\Omega F(x,u(x))\dd{x}$ is of class $\mathcal{C}^1$ and its differential is given by $h\mapsto \int_\Omega f(x,u(x))h(x)\dd{x}$. Moreover:
    $$
      \int_\Omega\abs{\grad(u+h)}^2-\int_\Omega\abs{\grad u}^2=2\int_\Omega \grad u\cdot \grad h+\o{\norm{h}_{H_0^1}}
    $$
    Since, $u\mapsto \int_\Omega \grad u\cdot \grad h$ is linear and continuous, we have that $I$ is of class $\mathcal{C}^1$ and its differential is given by:
    $$
      \dd{I(u)}h=\int_\Omega \grad u\cdot \grad h-\int_\Omega f(x,u(x))h(x)\dd{x}
    $$
    Integrating the hypothesis on $f$, we deduce that:
    \begin{itemize}
      \item $\abs{F(x,t)}\leq \tilde{C} (1+\abs{t}^{\theta+1})$ $\forall (x,t)\in \Omega\times \RR$ with $1\leq \theta\leq 2^*$ (if $d\geq 3$) and $1\leq \theta<\infty$ (if $d=2$).
      \item $F(x,t)\leq C'\abs{t}$ $\forall (x,t)\in \Omega\times \RR$.
    \end{itemize}
    Thus:
    \begin{multline*}
      I(u)\geq \frac{1}{2}{\norm{\grad u}_{L^2}}^2-C'\int \abs{u}\geq \frac{1}{2}{\norm{\grad u}_{L^2}}^2-C''{\norm{u}_{L^2}}\geq \\\geq \frac{1}{2} {\norm{\grad u}_{L^2}}^2-\bar{C}{\norm{\grad u}_{L^2}}
      =-\frac{\bar{C}^2}{2}+\frac{1}{2}{\left(\norm{\grad u}_{L^2}-\bar{C}\right)}^2
    \end{multline*}
    where we used \mnameref{ATFAPDE:poincare_ineq} in the third inequality. So $\displaystyle \inf_{u\in H_0^1(\Omega)}I(u)\geq -\frac{\bar{C}^2}{2}>-\infty$. Thus, $I$ is bounded from below. Moreover, $I$ is \emph{coercive} in the sense that $\displaystyle \lim_{\norm{u}_{H_0^1}\to\infty}I(u)=+\infty$.

    Now take a minimizing sequence $(u_n)$ for $I$. Then, $\displaystyle \sup_{n\in\NN}I(u_n)<\infty$ and by the coercivity property we have $\displaystyle \sup_{n\in\NN}\norm{u_n}_{H_0^1}<\infty$. After extraction, we have $u_n\overset{H_0^1}{\rightharpoonup} \underline{u}$ for some $\underline{u}\in H_0^1(\Omega)$ and using \mcref{INEPDE:minimization_prop1} we have a compact embedding $H_0^1(\Omega)\hookrightarrow L^p(\Omega)$ for any $1< p< 2^*$, so $u_n\overset{L^p}{\to} \underline{u}$. Using the growth property and taking $p=\theta+1<2^*$ we conclude that $F(\cdot,u_n(\cdot))\overset{L^{p/\theta}}{\to} F(\cdot,\underline{u}(\cdot))$. So, $\int_\Omega F(x,u_n(x))\dd{x}\to \int_\Omega F(x,\underline{u}(x))\dd{x}$. On the other hand, since $u_n\overset{H_0^1}{\rightharpoonup} \underline{u}$, we have that $\displaystyle \norm{\underline{u}}_{H_0^1}\leq \liminf_{n\to\infty}\norm{u_n}_{H_0^1}$. Thus, if $\displaystyle m:=\min_{u\in H_0^1(\Omega)}I(u)$, we have:
    \begin{itemize}
      \item $\displaystyle I(\underline{u})\leq \liminf_{n\to\infty}I(u_n)=m$.
      \item $I(\underline{u})\geq m$ because $\underline{u}\in H_0^1(\Omega)$.
    \end{itemize}
    So $\underline{u}$ is a minimizer for $I$. Moreover, this implies that $\int_\Omega \abs{\grad u_n}^2\to \int_\Omega \abs{\grad \underline{u}}^2$, so $u_n\overset{H_0^1}{\to} \underline{u}$. Since, $\underline{u}$ is a minimizer for $I$, we have that the map $t\mapsto I(\underline{u}+th)$ has a minimum at $t=0$. Thus, $\forall h\in H_0^1(\Omega)$:
    $$
      \dd{I(\underline{u})}h=\int_\Omega \grad \underline{u}\cdot \grad h-\int_\Omega f(x,\underline{u}(x))h(x)\dd{x}=0
    $$
    So $\underline{u}$ is a weak solution to the problem of \mcref{INEPDE:eq_problem_min}.
  \end{proof}
  \begin{theorem}[Bootstrap]
    Let $f:\Omega\times \RR\to\RR$ be Carathéodory satisfying the growth condition $\abs{f(x,t)}\leq C(1+\abs{t}^\theta)$ $\forall (x,t)\in \Omega\times \RR$ with $\theta\geq 1$. Assume $\Fr{\Omega}\in \mathcal{C}^2$ and $1\leq p<\infty$. We have an isomorphism $-\laplacian:W^{2,p}(\Omega)\cap W^{1,p}\to L^p(\Omega)$, meaning that for each $g\in L^p(\Omega)$ there exists a unique strong solution $\underline{u}$ of
    $$
      \begin{cases}
        -\laplacian u=g    & \text{in }\Omega      \\
        u|_{\Fr{\Omega}}=0 & \text{on }\Fr{\Omega}
      \end{cases}
    $$
    in $W^{2,p}$. Then, $\underline{u}\in\mathcal{C}^{0,\alpha}(\overline{\Omega})$ for $0<\alpha<1$ and $\displaystyle \underline{u}\in \bigcap_{1\leq p<\infty}W^{2,p}(\Omega)$.
  \end{theorem}
  \begin{proof}
    Define $g(x)=\Phi_f(\underline{u})(x)=f(x,\underline{u}(x))$. We have that $\underline{u}\in H_0^1(\Omega)$ (because it is a weak solution), so by \mcref{INEPDE:minimization_prop1} $\underline{u}\in L^{2^*}$. Thus, $g\in L^{p_1}$ with $p_1=\frac{2^*}{\theta}$. So $\underline{u}\in W^{2,p_1}$ and thus $\underline{u}\in L^{q_1}$ with $\frac{1}{q_1}=\frac{1}{p_1}-\frac{2}{d}$ (critical Sobolev embedding). Hence, we get $g\in L^{p_2}$ with $p_2=\frac{q_1}{\theta}$. We can repeat this process as long as $p_n<\frac{d}{2}$. We study the sequence $a_n=\frac{1}{p_n}$. In the process we have that if $a_n>\frac{2}{d}$, then:
    $$
      a_{n+1}=\theta a_n-\frac{2}{d}\theta
    $$
    with $a_1=\frac{\theta}{2}-\frac{\theta}{d}$.
    The fixed point is $r:=\frac{2\theta}{d(\theta-1)}$. So:
    $$
      a_n=r+\theta^n(a_1-r)
    $$
    But an easy check shows that $a_1-r<0$, so $a_n\to -\infty$, which is a contradiction since $a_n> \frac{2}{d}$. Thus, the process stops after a finite number of times, and thus, we get $\underline{u}\in\mathcal{C}^{0,\alpha}(\overline{\Omega})$ for $0<\alpha<1$ and $\displaystyle \underline{u}\in \bigcap_{1\leq p<\infty}W^{2,p}(\Omega)$.
  \end{proof}
  \subsubsection{Nonlinear case with constraints}
  \begin{theorem}[Lagrange multipliers]
    Let $E$ be a normed space and $I,J\in \mathcal{C}^1(E,\RR)$. Assume that:
    \begin{itemize}
      \item For some $\mu\in\RR$ and all $u\in E$ we have that if $J(u)=\mu$, then $\dd{J(u)}\ne0$.
      \item $\exists \underline{u}\in E$ such that $J(\underline{u})=\mu$ and $I(\underline{u})=\displaystyle \min_{\substack{u\in E \\ J(u)=\mu}}I(u)$.
    \end{itemize}
    Then, $\exists \lambda\in\RR$, called \emph{Lagrange multiplier}, such that $\dd{I(\underline{u})}=\lambda \dd{J(\underline{u})}$.
  \end{theorem}
  \begin{theorem}[Lagrange multipliers in several variables]
    Let $E$ be a normed space and $I,J_1,\dots,J_m\in \mathcal{C}^1(E,\RR)$. Assume that:
    \begin{itemize}
      \item For some $\mu_1,\dots,\mu_m\in\RR$ and all $u\in E$ we have that if $J_i(u)=\mu_i$ for all $i=1,\dots,m$, then $\dd{J_1(u)}, \ldots, \dd{J_m(u)}$ are linearly independent in $E^*$.
      \item $\exists \underline{u}\in E$ such that $J_i(\underline{u})=\mu_i$ for all $i=1,\dots,m$ and $I(\underline{u})=\displaystyle \min_{\substack{u\in E \\ J_i(u)=\mu_i\  \forall i}}I(u)$.
    \end{itemize}
    Then, $\exists \lambda_1,\dots,\lambda_m\in\RR$, called \emph{Lagrange multipliers}, such that: $$\dd{I(\underline{u})}=\lambda_1 \dd{J_1(\underline{u})}+\dots+\lambda_m \dd{J_m(\underline{u})}$$
  \end{theorem}
  \begin{proposition}[Aplication]\label{INEPDE:lagrange_apl}
    Let $f:\Omega\times \RR\to\RR$ be a Carathéodory function defined by $f(x,t)=\abs{t}^{\theta}\sign(t)$, with $1\leq \theta\leq \frac{d+2}{d-2}$
    and define the following functionals in $E=H_0^1(\Omega)$:
    $$
      I(u)=\frac{1}{2}\int_\Omega \abs{\grad u}^2\qquad J(u)=\int_\Omega F(x,u)\dd{x}
    $$
    with $F(x,t)=\int_0^t f(x,s)\dd{s}$. Then, $\tilde{u}=\underline{u}/t$ is a weak solution to the problem:
    \begin{equation}\label{INEPDE:problem_lagrange_apl}
      \begin{cases}
        -\laplacian u=f(x,u) & \text{in }\Omega      \\
        u|_{\Fr{\Omega}}=0   & \text{on }\Fr{\Omega}
      \end{cases}
    \end{equation}
    where $\underline{u}$ is the minimizer of the problem
    $\displaystyle
      \min_{\substack{u\in H_0^1(\Omega) \\ J(u)=1}}I(u)
    $.
  \end{proposition}
  \begin{proof}
    We will solve first a much simpler problem:
    \begin{equation}\label{INEPDE:aux_problem_lagrange}
      \begin{cases}
        -\laplacian u=\lambda f(x,u) & \text{in }\Omega      \\
        u|_{\Fr{\Omega}}=0           & \text{on }\Fr{\Omega}
      \end{cases}
    \end{equation}
    with $\lambda>0$. Denote by $m$ the minimizer of $I$ under $J(u)=1$. Since $F(x,t)=\frac{\abs{t}^{\theta+1}}{\theta+1}$, under $J(u)=1$ we have that ${\norm{u}_{L^{\theta+1}}}^{\theta+1}=\theta+1$. Now, since $\theta+1\leq 2^*$, we have a continuous embedding $H_0^1(\Omega)\hookrightarrow L^{\theta+1}(\Omega)$, so $\frac{1}{2}{\norm{\grad u}_{L^2}}^2\geq C {\norm{u}_{L^{\theta+1}}}^2\geq K>0$. Thus, $m\geq K>0$. Now, take a minimizing sequence $(u_n)$ for $I$. Since $u_n$ is bounded in $H_0^1$, after extraction we have $u_n\overset{H_0^1}{\rightharpoonup} \underline{u}$ for some $\underline{u}\in H_0^1(\Omega)$. Moreover, $u_n\overset{L^{\theta+1}}{\to} \underline{u}$ by compact embedding. Thus, $1=J(u_n)\to J(\underline{u})$. So $J(\underline{u})=1$ and since $m=\displaystyle\liminf_{n\to\infty}I(u_n)\geq I(\underline{u})$ and $I(\underline{u})\geq m$, we have that $\underline{u}$ is a minimizer for $I$ under $J(u)=1$. Now, we know that $I,J$ are of class $\mathcal{C}^1$ on $H_0^1(\Omega)$ and
    $$
      \dd{J(u)}h = \int_\Omega \abs{u}^{\theta-1}uh
    $$
    If $J(u)=1$, then $\dd{J(u)}u=\theta+1\ne 0$. So there is a Lagrange multiplier $\lambda\in\RR$ such that $\dd{I(u)}=\lambda \dd{J(u)}$, that is:
    $$
      \int_\Omega \grad \underline{u}\cdot \grad h=\lambda \int_\Omega \abs{\underline{u}}^{\theta-1}\underline{u}h
    $$
    Whence $\underline{u}$ is a weak solution of \mcref{INEPDE:aux_problem_lagrange}. Note that taking $h=\underline{u}$ we deduce that $\lambda>0$.

    Now take $t=\lambda^{-\frac{1}{\theta-1}}>0$ and $\tilde{u}=t^{-1}\underline{u}$. Then:
    $$
      -\laplacian(\tilde{u}t)=\lambda t^{\theta-1}\abs{\tilde{u}}^{\theta-1}\tilde{u}t\iff -\laplacian \tilde{u}= \abs{\tilde{u}}^{\theta-1}\tilde{u}=f(x,\tilde{u})
    $$
    So $\tilde{u}$ is a weak solution in $H_0^1(\Omega)$ of \mcref{INEPDE:problem_lagrange_apl} and $\tilde{u}\ne 0$ because $\frac{1}{\theta+1}\int_\Omega \abs{\tilde{u}}^{\theta+1}=\lambda^{\frac{\theta+1}{\theta-1}}>0$.
  \end{proof}
  \begin{remark}
    In general, it suffices to have $f:\Omega\times \RR\to\RR$ Carathéodory with:
    \begin{itemize}
      \item $\abs{f(x,t)}\leq C(1+\abs{t}^\theta)$ $\forall (x,t)\in \Omega\times \RR$ with $1\leq \theta\leq \frac{d+2}{d-2}$ (if $d\geq 3$) and $1\leq \theta<\infty$ (if $d=2$).
      \item $\displaystyle f(x,t)t\geq C'\min_{2\leq \alpha,\beta\leq \theta+1}\{\abs{t}^\alpha,\abs{t}^\beta\}$ $\forall (x,t)\in \Omega\times \RR$.
    \end{itemize}
  \end{remark}
  \begin{remark}
    If $J$ is not homogeneous we cannot proceed as in the proof. But in this case we use the \emph{Nehari manifold method}.
  \end{remark}
  \begin{proposition}[Nehari manifold method]
    Let $f$ be as in \mnameref{INEPDE:lagrange_apl} with the additional assumptions that:
    \begin{itemize}
      \item $t\mapsto f(\cdot,t)$ is $\mathcal{C}^1$ with a growth condition $\abs{\pdv{f}{t}}\leq C(1+\abs{t}^{\theta-1})$.
      \item $f(x,t)t< \partial_tf(x,t)t^2$ $\forall (x,t)\in \Omega\times \RR^*$.
    \end{itemize}
    Let $\mathcal{N}:=\{u\in H_0^1(\Omega)\setminus\{0\}:J(u)=0\}$, where:
    \begin{align*}
      I(u) & =\frac{1}{2}\int_\Omega \abs{\grad u}^2-\int_\Omega F(x,u)\dd{x} \\
      J(u) & =\dd{I(u)}u = \int_\Omega \abs{\grad u}^2 -\int_\Omega f(x,u)u
    \end{align*}
    Then, if $\underline{u}\in\mathcal{N}$ is a minimizer of $I$ under $J(u)=0$, then $\dd{I(\underline{u})}=0$ and so $\underline{u}$ is a weak solution to \mcref{INEPDE:problem_lagrange_apl}.
  \end{proposition}
  \begin{proof}
    We have that:
    $$
      \dd{J(u)}h=2\int_\Omega \grad u\cdot \grad h-\int_\Omega [\partial_uf(x,u)u +f(x,u)]h
    $$
    Thus, if $u\in \mathcal{N}$, we have:
    $$
      \dd{J(u)}u=\int_\Omega[f(x,u)u -\partial_uf(x,u)u^2] <0
    $$
    because $J(u)=0$ and at the end we used one of the extra hypothesis on $f$. Now assume $\underline{u}\in\mathcal{N}$ and $I(\underline{u})=\displaystyle \min_{\substack{u\in H_0^1(\Omega) \\ J(u)=0}}I(u)$. Then, $\exists \lambda\in\RR$ such that $\dd{I(\underline{u})}=\lambda \dd{J(\underline{u})}$. Thus:
    $$
      \int_\Omega [\grad \underline{u}\cdot \grad h-f(x,\underline{u})h]=\lambda \int_\Omega [\partial_uf(x,\underline{u})\underline{u}+f(x,\underline{u})-f(x,\underline{u})]h
    $$
    Moreover, $\int_\Omega \abs{\grad \underline{u}}^2=\int_\Omega f(x,\underline{u}) \underline{u}$. So taking $h=\underline{u}$ we get:
    $$
      0=\lambda \int_\Omega [f\underline{u}-\partial_uf\underline{u}^2]
    $$
    which implies $\lambda=0$ because of the extra hypothesis on $f$.
  \end{proof}
  \subsubsection{Mountain pass method}
  Our goal in this section is again find a nonzero weak solution in $H_0^1(\Omega)$ to \mcref{INEPDE:problem_lagrange_apl}.
  \begin{definition}
    Let $E$ be a Banach space and $I\in\mathcal{C}^1(E,\RR)$. We say that $I$ satisfies the \emph{Palais-Smale condition at level $c$} if every sequence $(u_n)$ in $E$, such that $I(u_n)\to c$ and $\dd{I(u_n)}\to 0$ in $E^*$, has a convergent subsequence (that is, is precompact).
  \end{definition}
  \begin{theorem}[Ambrosetti-Rabinowitz theorem]
    Let $E$ be a Banach space and $I\in\mathcal{C}^1(E,\RR)$. Assume that $\exists a\ne b\in E$ such that
    $$
      c:=\inf_{\gamma\in \Gamma}\max_{t\in [0,1]}I(\gamma(t))>\max\{I(a),I(b)\}
    $$
    with $$
      \Gamma:=\{\gamma\in \mathcal{C}([0,1],E):\gamma(0)=a,\gamma(1)=b\}
    $$
    Then, there is a sequence $(u_n)$ in $E$ such that $I(u_n)\to c$ and $\dd{I(u_n)}\to 0$ in $E^*$. Such a sequence is called a \emph{Palais-Smale sequence}.
  \end{theorem}
  \begin{corollary}[Mountain pass theorem]\label{INEPDE:mountain_pass}
    Let $E$ be a Banach space and $I\in\mathcal{C}^1(E,\RR)$. Assume that $\exists a\ne b\in E$ such that
    $$
      c:=\inf_{\gamma\in \Gamma}\max_{t\in [0,1]}I(\gamma(t))>\max\{I(a),I(b)\}
    $$
    with $$
      \Gamma:=\{\gamma\in \mathcal{C}([0,1],E):\gamma(0)=a,\gamma(1)=b\}
    $$
    If, moreover, $I$ satisfies the Palais-Smale condition at level $c$, then $\exists u_*\in E$ such that $I(u_*)=c$ and $\dd{I(u_*)}=0$.
  \end{corollary}
  \begin{proposition}
    Let $f:\Omega\times \RR\to\RR$ be Carathéodory satisfying:
    \begin{itemize}
      \item $f(x,t)t\geq p F(x,t)$ $\forall (x,t)\in \Omega\times \RR$ (\emph{superquadradicity condition}).
      \item $f(x,t)t\leq \overline{C}\abs{t}^{p_1}$ for $\abs{t}\geq 1$.
      \item $f(x,t)t\geq \underline{C} \abs{t}^{p_2}$ for $\abs{t}\leq 1$.
    \end{itemize}
    with $2<p,p_1,p_2<2^*$ and $F(x,t)=\int_0^tf(x,s)\dd{s}$. Consider the functional:
    $$
      I(u)=\frac{1}{2}\int_\Omega \abs{\grad u}^2-\int_\Omega F(x,u)\dd{x}
    $$
    Then, $\exists \underline{u}\in H_0^1(\Omega)$ such that $I(\underline{u})=\displaystyle \min_{u\in H_0^1(\Omega)}I(u)$ and $\underline{u}$ is a weak solution to \mcref{INEPDE:problem_lagrange_apl}.
  \end{proposition}
  \begin{proof}
    First of all, note that the thrid hypothesis on $f$ implies that $F(x,t)\geq 0$ for $\abs{t}\leq 1$. From the superquadradicity condition, for $t>0$, the function $\abs{t}^{-p}F(x,t)$ is nondecreasing (the derivative is nonnegative). So, for $0\leq t\leq 1$ we have $F(x,t)\leq \abs{t}^p F(x,1)$. Similarly, for $-1\leq t\leq 0$ the function is nonincreasing and so we have $F(x,t)\leq \abs{t}^p F(x,-1)$. Using the upper estimate we get, for $\abs{t}\geq 1$, ${F(x,t)}\leq \overline{\overline{C}} \abs{t}^{p_1}$ and so
    $\abs{F(x,t)}\leq C'(\abs{t}^p+\abs{t}^{p_1})$ $\forall t$. So:
    \begin{align*}
      \int_\Omega {F(x,u)} & \leq C'\left(\norm{u}_{L^{p}}^p+\norm{u}_{L^{p_1}}^{p_1}\right)        \\
                           & \leq C''\left(\norm{\grad u}_{L^2}^p+\norm{\grad u}_{L^2}^{p_1}\right)
    \end{align*}
    by \mnameref{ATFAPDE:poincare_ineq} and ?????. And thus:
    \begin{align}
      I(u) & \geq \norm{\grad u}_{L^2}^2\left(\frac{1}{2}-C''\left[\norm{\grad u}_{L^2}^{p-2}+\norm{\grad u}_{L^2}^{p_1-2}\right]\right)\nonumber \\
           & \label{INEPDE:I_mountain}\geq \frac{1}{4}\norm{u}_{H_0^1}^2
    \end{align}
    for $\norm{u}_{H_0^1}\leq r$ with $r>0$ small enough. Now, take $u_1\in H_0^1(\Omega)\setminus\{0\}$ and $\lambda>0$ to be chosen later. From the previous reasoning, we have $F(x,t)\geq F(x,1)\abs{t}^{p}$ for $t\geq 1$ and $F(x,t)\geq F(x,-1)\abs{t}^{p}$ for $t\leq -1$. So, $F(x,t)\geq K\abs{t}^{p}\geq0$ for some $K>0$ and all $\abs{t} \geq 1$. Now, since $u_1\ne 0$ $\exists \varepsilon>0$ such that $\int_\Omega \abs{u_1}^p\indi{\{\abs{u_1}\geq \varepsilon\}}>0$. So for $\lambda\geq \frac{1}{\varepsilon}$ we have:
    \begin{multline*}
      I(\lambda u_1) \leq \frac{\lambda^2}{2}\norm{\grad u_1}_{L^2}^2-\int_\Omega F(x,\lambda u_1)\indi{\{\abs{u_1}\geq \varepsilon\}}\leq\\\leq \frac{\lambda^2}{2}\norm{\grad u_1}_{L^2}^2-K\lambda^p\int_\Omega \abs{u_1}^p\indi{\{\abs{u_1}\geq \varepsilon\}}=\\=A\lambda^2-B\lambda^p\overset{\lambda\to\infty}{\longrightarrow} -\infty
    \end{multline*}
    where the first inequality follows from the fact that $F(x,t)\geq 0$ for $\abs{t}\leq 1$. So we may choose $\lambda=\lambda_1>0$ such that $I(\lambda_1 u_1)\leq 0$ and given the previous $r>0$ we choose $u_1$ with $\norm{\lambda_1 u_1}_{H_0^1}>r$. Now let
    $$
      \Gamma:=\{\gamma\in \mathcal{C}([0,1],H_0^1(\Omega)):\gamma(0)=0,\gamma(1)=\lambda_1 u_1\}
    $$
    and define $c:=\displaystyle \inf_{\gamma\in \Gamma}\max_{t\in [0,1]}I(\gamma(t))$. Take $\gamma\in \Gamma$. Since $\norm{\gamma(0)}_{H_0^1}=0$ and $\norm{\gamma(1)}_{H_0^1}> r$, $\exists t_0\in (0,1)$ such that $\norm{\gamma(t_0)}_{H_0^1}=r$. So by \mcref{INEPDE:I_mountain} we have:
    $$
      c =\displaystyle \inf_{\gamma\in \Gamma}\max_{t\in [0,1]}I(\gamma(t))\geq \frac{r^2}{4}>0=\max\{I(0),I(\lambda_1 u_1)\}
    $$
    In order to use \mnameref{INEPDE:mountain_pass} it's missing to check that $I$ satisfies the Palais-Smale condition at level $c$. Let $(u_n)$ be a Palais-Smale sequence at level $c$. We then have:
    $$
      \begin{cases}
        I(u_n)\to c \\
        \dd{I(u_n)}\overset{H^{-1}}{\longrightarrow} 0
      \end{cases}$$
    The second equation implies that $\dd{I(u_n)}u_n\to 0$ and thus:
    $$
      \begin{cases}
        \displaystyle\frac{1}{2}\int_\Omega \abs{\grad u_n}^2-\int_\Omega F(x,u_n)\dd{x}=c+\o{1} \\
        \displaystyle\int_\Omega \abs{\grad u_n}^2-\int_\Omega f(x,u_n)u_n\dd{x}=\o{\norm{u_n}_{H_0^1}}
      \end{cases}
    $$
    From here subtracting the first equation (multiplied by $p$) to the second one, we have:
    \begin{multline*}
      \left(1-\frac{p}{2}\right)\int_\Omega \abs{\grad u_n}^2\dd{x}+\int_\Omega \left[pF(x,u_n)-f(x,u_n)u_n\right]\dd{x}=\\
      =-pc+\o{1} + \o{\norm{u_n}_{H_0^1}}
    \end{multline*}
    By hypothesis the second term is negative, so:
    $$
      \left(\frac{1}{2}- \frac{1}{p}\right)\int_\Omega \abs{\grad u_n}^2\dd{x}\leq c + \o{1} + \o{\norm{u_n}_{H_0^1}}
    $$
    So $\exists K>0$ such that $\norm{u_n}_{H_0^1}\leq K$ $\forall n\in\NN$. So after extracting a subsequence we have $u_n\overset{H_0^1}{\rightharpoonup} u$ for some $u\in H_0^1(\Omega)$ and by compact embedding $u_n\overset{L^p}{\longrightarrow} u$ for all $1\leq p<2^*$. But $f$ is Carathéodory with growth condition $\abs{f(x,t)}\leq C(1+\abs{t}^{\theta})$ with $1\leq \theta =p_1-1<\frac{d+2}{d-2}$. So $f(x,u_n)\overset{L^q}{\longrightarrow} f(x,u)$ for all $1\leq q<\frac{2^*}{\theta}$. Now, by duality, the continuous embedding $H_0^1\hookrightarrow L^{2^*}$ gives $L^{\hat{q}} \hookrightarrow H^{-1}$ with $\frac{1}{\hat{q}}+\frac{1}{2^*}=1$. An easy computation shows that:
    $$
      \hat{q}=\frac{2d}{d-2}\implies \theta\hat{q}<2^*\implies \hat{q}<\frac{2^*}{\theta}
    $$
    So $f(x,u_n)\overset{H^{-1}}{\longrightarrow} f(x,u)$. Now since
    $$
      \dd{I(u_n)}h={\langle -\laplacian u_n-f(x,u_n),h\rangle}_{H^{-1}\times H_0^1}
    $$
    we have $-\laplacian u_n=f(x,u_n)+r_n$ with $r_n=\dd{I(u_n)}\overset{H^{-1}}{\longrightarrow} 0$. Thus, $-\laplacian u_n\overset{H^{-1}}{\longrightarrow} f(x,u)$ (and so $u_n\overset{H_0^1}{\longrightarrow} {(-\laplacian)}^{-1}f(x,u)$) and since $u_n\overset{H_0^1}{\rightharpoonup} u$ implies $-\laplacian u_n\overset{H^{-1}}{\rightharpoonup} -\laplacian u$, we have $-\laplacian u=f(x,u)$. This implies that in fact $u_n\overset{H_0^1}{\longrightarrow}u$ and so $I(u)=\displaystyle \lim_{n\to\infty}I(u_n)=c$.
  \end{proof}
\end{multicols}
\end{document}