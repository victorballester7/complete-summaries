\documentclass[../../../main_math.tex]{subfiles}

\begin{document}
\changecolor{ADS}
\begin{multicols}{2}[\section{Advanced dynamical sytems}]
  \subsection{Discrete maps}
  \subsubsection{Maps in \texorpdfstring{$\TT^1$}{S1}}
  \begin{proposition}
    Let $\alpha=\frac{p}{q}\in\QQ$ and let $R_\alpha:\TT^1\to \TT^1$ be the rotation of angle $\alpha$. Then, all the points of $\TT^1$ are periodic for $R_\alpha$ with period $q$.
  \end{proposition}
  \begin{proof}
    We identify the elements of $\TT^1$ as $\quot{\RR}{\ZZ}$. Let $x\in \TT^1$. Then, ${R_\alpha}^q x=x+\alpha q=x+p=x$. And $q$ is the smallest integer such that ${R_\alpha}^q x=x$ because we assume that $p$ and $q$ are coprime.
  \end{proof}
  \begin{proposition}
    Let $\alpha\in\RR\setminus\QQ$ and let $R_\alpha:\TT^1\to \TT^1$ be the rotation of angle $\alpha$. Then, all the orbits of $R_\alpha$ are dense in $\TT^1$.
  \end{proposition}
  \begin{proof}
    Let $\varepsilon>0$, $x,y\in \TT^1$. Discretize $\TT^1$ in intervals of length at most $\frac{1}{\varepsilon}$. Then, $\exists m,n\in \NN$ with $m< n\leq \frac{1}{\varepsilon}+1$ such that ${R_\alpha}^m x$ and ${R_\alpha}^nx$ are in the same interval. Thus, $\abs{{R_\alpha}^{n-m}x-x}<\varepsilon$. Now, concatenating ${R_\alpha}^{n-m}x$ repeatedly, we will eventually have $\abs{{R_\alpha}^{k(n-m)}x - y}<\varepsilon$ for some $k\in \NN$.
  \end{proof}
  \begin{corollary}
    Let $\alpha\in\RR\setminus\QQ$ and $A\subset \TT^1$ be a non-empty closed invariant set for $R_\alpha$. Then, $A=\TT^1$.
  \end{corollary}
  \begin{proof}
    Let $x\in \TT^1$ and $y\in A$. Then, $\forall k\in\NN$ $\exists n_k\in\NN$ such that $R_\alpha^{n_k}y\in(x-\frac{1}{k},x+\frac{1}{k})$. Thus, $R_\alpha^{n_k}y\overset{k\to\infty}{\longrightarrow}x$ and $x\in A$ because $A$ is closed and $R_\alpha^{n_k}y\in A$ $\forall k\in\NN$ because $A$ is invariant.
  \end{proof}
  \begin{definition}
    Consider the set $$\Sigma_m
      := \{(x_1,x_2,\ldots):x_i\in\{0,1,\ldots,m-1\}\}$$
    We define the \emph{shift map} as:
    $$
      \function{\sigma_m}{\Sigma_m}{\Sigma_m}{(x_1,x_2,\ldots)}{(x_2,x_3,\ldots)}
    $$
  \end{definition}
  \begin{remark}
    Note that some elements in $[0,1]$ have two different representations in base-$m$ identified as elements of $\Sigma_m$. So we can think of $\Sigma_m$ as the quotient space $\quot{\Sigma_m}{\sim}$, where $(x_1,x_2,\ldots)\sim (y_1,y_2,\ldots)$ if and only if $\sum_{i=1}^\infty \frac{x_i}{m^i}=\sum_{i=1}^\infty \frac{y_i}{m^i}$.
  \end{remark}
  \begin{proposition}
    Let $m\in\NN$. Consider the \emph{expansion map}
    $$
      \function{E_m}{\TT^1}{\TT^1}{x}{mx}
    $$
    Then, if $\phi:\Sigma_m\to \TT^1$ is the map $\phi(x_1,x_2,\ldots)=\sum_{i=1}^\infty \frac{x_i}{m^i}$, we have that $E_m\circ \phi=\phi\circ \sigma_m$. In particular, $\phi$ is a bijection, and thus it is a conjugacy between $E_m$ and $\sigma_m$.
  \end{proposition}
  \begin{proof}
    Let $x=(x_1,x_2,\ldots)\in \Sigma_m$. Then, $\phi\circ \sigma_m(x)=\sum_{i=1}^\infty \frac{x_{i+1}}{m^i}$. Moreover:
    \begin{equation*}
      E_m\circ \phi(x)=m\sum_{i=1}^\infty \frac{x_i}{m^i}=x_i+\sum_{i=1}\frac{x_{i+1}}{m^i}\equiv\sum_{i=1}\frac{x_{i+1}}{m^i}
    \end{equation*}
  \end{proof}
  \begin{remark}
    Note that $E$ preserves the Lebesgue measure \textit{backwards}: $\abs{{E_m}^{-1}(A)}=\abs{A}$ for all $A\subseteq \TT^1$, but $\abs{E_m(A)}\ne \abs{A}$ in general.
  \end{remark}
  \begin{definition}
    We define the following distance in $\Sigma_m$. For all $x,x'\in\Sigma_m$:
    $$
      d(x,x'):=\frac{1}{2^\ell}\quad\text{with }\ell:=\min\{i:x_i\ne x_i'\}
    $$
  \end{definition}
  \begin{proposition}
    Periodic points of $E_m$ are dense in $\TT^1$.
  \end{proposition}
  \begin{proof}
    By conjugacy it suffices to show that periodic points of $\sigma_m$ are dense in $\Sigma_m$. Let $x\in \Sigma_m$ and $\varepsilon>0$. Then, $\varepsilon>\frac{1}{2^\ell}$ for some $\ell$. And so the orbit of
    $$
      y=(x_1,\ldots,x_\ell,x_1,\ldots,x_\ell,x_1,\ldots,x_\ell,\ldots)
    $$
    is periodic and $d(x,y)<\varepsilon$. So periodic points of $\sigma_m$ are dense in $\Sigma_m$.
  \end{proof}
  \begin{proposition}
    There exists $x\in \TT^1$ such that its orbit under $E_m$ is dense in $\TT^1$.
  \end{proposition}
  \begin{proof}
    By conjugacy, we only prove it for $\sigma_m$. But this is clear by taking he sequence of \textit{all sequences}:
    \begin{multline*}
      x=(0,1,\ldots,m-1,0,0,1,0,0,1,1,1,0,2,2,0,1,2,2,1,\\2,2,\ldots,(m-1), (m-1),0,0,0,\ldots)
    \end{multline*}
  \end{proof}
  \subsubsection{A hyperbolic automorphism of \texorpdfstring{$\TT^2$}{T2}}
  \begin{proposition}
    Consider $\vf{A}=\begin{pmatrix}
        2 & 1 \\
        1 & 1
      \end{pmatrix}\in \GL_2(\RR)$. Then, $\vf{A}(\ZZ^2)=\ZZ^2$ and this induces an automorphism $\vf{\tilde{A}}$ of $\TT^2=\quot{\RR^2}{\ZZ^2}$.
  \end{proposition}
  \begin{definition}
    We define the set of periodic points of $\vf{\tilde{A}}$ as $\Per\vf{\tilde{A}}$.
  \end{definition}
  \begin{lemma}
    $\Per\vf{\tilde{A}}=\quot{\QQ^2}{\ZZ^2}$. Thus, $\Per\vf{\tilde{A}}$ is dense in $\TT^2$.
  \end{lemma}
  \begin{proof}
    Let $\vf{x}\in \Per\vf{\tilde{A}}$. Then, $\exists k\in\NN$ and $\vf{n}\in\ZZ^2$ such that $\vf{A}^k\vf{x}=\vf{x}+\vf{n}$. One can easily check that $\sigma(\vf{\tilde{A}})=\left\{\frac{3}{2}\pm \frac{\sqrt{5}}{2}\right\}=:\{\lambda_{\pm}\}$ with $\lambda_-<1<\lambda_+$. Thus,
    $$
      \det(\vf{A}^k-\vf{I})=({\lambda_+}^k-1)({\lambda_-}^k-1)\ne 0
    $$
    and so the equation $\vf{A}^k\vf{x}=\vf{x}+\vf{n}$ has a unique (rational) solution. Now let $(\frac{p_1}{q_1},\frac{p_2}{q_2})\in \quot{\QQ^2}{\ZZ^2}$ and $N\geq 1$ left to be chosen. We define the set $Q_N:=\frac{\ZZ^2}{N} \mod{\ZZ^2}$, which is a subset finite set of $\TT^2$. Observe that $Q_N$ is invariant under $\vf{\tilde{A}}$, and thus, all of its points are periodic because the set is finite. For the above rational numbers, just choose $N=q_1q_2$.
  \end{proof}
  \begin{remark}
    The \emph{hyperbolicity} comes from the fact that there is one eigenvector with eigenvalue greater than $1$ and another with eigenvalue less than $1$, both eigenvalues being positive.
  \end{remark}
  \begin{theorem}
    The iterates of $\vf{\tilde{A}}$ smear every domain $F\subseteq \TT^2$ uniformly over $\TT^2$, that is, for every domain $G\subseteq \TT^2$, we have that the following limit exists:
    $$
      \abs{(\vf{\tilde{A}}^{-n} F)\cap G}\overset{n\to\infty}{\longrightarrow} \abs{F}\abs{G}
    $$
    This property of $\vf{\tilde{A}}$ is called \emph{mixing}.
  \end{theorem}
  \begin{proof}
    We can prove a more general property in terms of functions in the torus (and then apply it to $f=\indi{F}$ and $g=\indi{G}$):
    $$
      \lim_{n\to\infty}\int_{\TT^2} f(\vf{\tilde{A}}^n \vf{x}) g(\vf{x})\dd{\vf{x}}=\int_{\TT^2} f(\vf{x})\dd{\vf{x}}\int_{\TT^2} g(\vf{x})\dd{\vf{x}}
    $$
    We will prove this for the orthonormal basis of Fourier series $\{\exp{2\pi i \vf{p}\cdot \vf{x}}\}_{\vf{p}\in\ZZ^2}$. Note that:
    $$
      \int_{\TT^2} \exp{2\pi i (\transpose{(\vf{\tilde{A}}^n)}\vf{p})\cdot \vf{x}}\dd{\vf{x}}=\begin{cases}
        1 & \text{if }\vf{p}=\vf{0}    \\
        0 & \text{if }\vf{p}\ne \vf{0}
      \end{cases}
    $$
    Now for large $n$, the norm of the vector $\transpose{(\vf{\tilde{A}}^n)}\vf{p}$ is large for $\vf{p}\ne \vf{0}$ as we have:
    $$
      \vf{\tilde{A}}^n\vf{p} \simeq \lambda_+^n \langle \vf{p}, \vf{e}_+\rangle \vf{e}_+
    $$
    And so its transpose will eventually be different from $-\vf{q}$. Therefore, we have that if $g=\exp{2\pi i \vf{q} \cdot \vf{x}}$ then:
    $$
      \lim_{n\to\infty}\int_{\TT^2} \exp{2\pi i(\transpose{(\vf{\tilde{A}}^n)}\vf{p}+\vf{q})\cdot \vf{x}}\dd{\vf{x}}=0
    $$
    So for any $\vf{p}, \vf{q}\in\ZZ^2$ we have the equality. Then, we use that any function nice enough can be approximated with its Fourier series.
  \end{proof}
  \begin{theorem}
    On the torus $\TT^2$ there exist two direction fields invariant with respect to the automorphism $\vf{\tilde{A}}$. The integral curves of each of these directions fields are everywhere dense on the torus. The automorphism $\vf{\tilde{A}}$ converts the integral curves of each field into integral curves of the same field, expanding by $\lambda_+$ for the first field and contracting by $\lambda_-$ for the second.
  \end{theorem}
  \begin{proof}
    Let $\vf{e}_+$ and $\vf{e}_-$ be the eigenvectors of $\vf{A}$ with eigenvalues $\lambda_+$ and $\lambda_-$ respectively. Let $\vf{x}\in \TT^2$ and
    $$
      \function{\vf\gamma_+}{\RR}{\TT^2}{t}{\vf{x}+t \vf{e}_+}\quad
      \function{\vf\gamma_-}{\RR}{\TT^2}{t}{\vf{x}+t \vf{e}_-}
    $$
    be the expanding and contracting curves and let $\vf{\xi}_{\vf{x}}=\im(\vf\gamma_+)$, $\vf{\eta}_{\vf{x}}=\im(\vf\gamma_-)$ be the corresponding direction fields. The density of the curves is a consequence of the density of orbits in rotation maps in the circle with irrational angle.
  \end{proof}
  \begin{definition}
    Let $\vf{A},\vf{B}:\TT^2\rightarrow \TT^2$ be $\mathcal{C}^1$ functions. We say that $B$ is \emph{$\mathcal{C}^0$-close} to $\vf{A}$ if for all $\varepsilon>0$:
    $$
      \sup_{\vf{x}\in \TT^2}\norm{\vf{A}(\vf{x})-\vf{B}(\vf{x})}<\varepsilon
    $$
    We say that $\vf{B}$ is \emph{$\mathcal{C}^1$-close} to $\vf{A}$ if $\vf{B}$ is $\mathcal{C}^0$-close to $\vf{A}$ and for all $\varepsilon>0$:
    $$
      \sup_{\vf{x}\in \TT^2}\norm{\vf{D}\vf{A}(\vf{x})-\vf{D}\vf{B}(\vf{x})}<\varepsilon
    $$
  \end{definition}
  \begin{theorem}[Structal stability]
    Let $\vf{B}$ be a diffeomorphism on $\TT^2$ which is $\mathcal{C}^1$-close to $\vf{\tilde{A}}$. Then, $\vf{B}$ is $\mathcal{C}^0$-conjugate to $\vf{\tilde{A}}$.
  \end{theorem}
  \begin{proof}
    We need to find a $\mathcal{C}^0$-conjugacy $\vf{H}$ between $\vf{B}$ and $\vf{\tilde{A}}$. Since, $\vf{B}$ is $\mathcal{C}^1$-close to $\vf{\tilde{A}}$, we may expect that both $\vf{H}$ and $\vf{B}$ are small perturbations of the identity and $\vf{\tilde{A}}$ respectively. So set $\vf{H}=\vf{I}+\vf{h}$ and $\vf{B}=\vf{\tilde{A}}+\vf{b}$. Then, we want to find $\vf{h}$ and $\vf{b}$ such that:
    $$
      \vf{H}\circ \vf{\tilde{A}}=\vf{B}\circ \vf{H}\iff
      \vf{h}(\vf{\tilde{A}x})-\vf{\tilde{A}} \vf{h}(\vf{x})=\vf{b}(\vf{x}+\vf{h}(\vf{x}))
    $$
    This equation is called \emph{conjugacy equation}. Consider the operators
    \begin{gather*}
      \function{\vf{S}_{\vf{\tilde{A}}}}{\mathcal{C}^0(\RR^2,\RR^2)}{\mathcal{C}^0(\RR^2,\RR^2)}{\vf{h}}{\vf{h}(\vf{\tilde{A}}(\vf{x}))}\\
      \function{\vf{L}_{\vf{\tilde{A}}}}{\mathcal{C}^0(\RR^2,\RR^2)}{\mathcal{C}^0(\RR^2,\RR^2)}{\vf{h}}{\vf{S}_{\vf{\tilde{A}}}\vf{h}-\vf{\tilde{A}}\vf{h}}
    \end{gather*}
    where we consider the diffeomorphisms $\vf{\tilde{A}}$ and $\vf{B}$ as operators \textit{lifted} to $\mathcal{C}^1(\RR^2,\RR^2)$. Observe that:
    $$
      \sup_{\vf{x}\in \RR^2}\norm{\vf{S}_{\vf{\tilde{A}}}\vf{h}(\vf{x})}=\sup_{\vf{x}\in \RR^2}\norm{\vf{S}_{\vf{\tilde{A}}}\vf{h}(\vf{\tilde{A}}^{-1}\vf{x})}= \sup_{\vf{x}\in \RR^2}\norm{\vf{h}(\vf{x})}
    $$
    Hence, $\norm{\vf{S}_{\vf{\tilde{A}}}}=1$ and similarly $\norm{\vf{S}_{\vf{\tilde{A}}}^{-1}}=1$, where $\vf{S}_{\vf{\tilde{A}}}^{-1}:\vf{h}\mapsto \vf{h}(\vf{\tilde{A}}^{-1}(\vf{x}))$. We'll now prove that $\vf{L}_{\vf{\tilde{A}}}$ is invertible. Note that $\RR^2=\langle \vf{e}_+\rangle \oplus \langle \vf{e}_-\rangle$ because $\vf{\tilde{A}}$ is invertible. Thus:
    $$
      \vf{L}_{\vf{\tilde{A}}}\vf{h}=\vf{c}\iff \begin{cases}
        \vf{L}_{\vf{\tilde{A}}}\vf{h}_+=\vf{S}_{\vf{\tilde{A}}}\vf{h}_+-\lambda_+\vf{h}_+=\vf{c}_+ \\
        \vf{L}_{\vf{\tilde{A}}}\vf{h}_-=\vf{S}_{\vf{\tilde{A}}}\vf{h}_--\lambda_-\vf{h}_-=\vf{c}_-
      \end{cases}
    $$
    where $\vf{h}=\vf{h}_++\vf{h}_-$, $\vf{c}=\vf{c}_++\vf{c}_-$ and $\vf{h}_\pm,\vf{c}_\pm\in \langle \vf{e}_\pm\rangle$. Now, note that $\norm{\frac{\vf{S}_{\vf{\tilde{A}}}}{\lambda_+}}<1$ and so
    $$
      (\vf{S}_{\vf{\tilde{A}}}-\lambda_+\vf{I})=\lambda_+\left(\frac{\vf{S}_{\vf{\tilde{A}}}}{\lambda_+}-\vf{I}\right)
    $$
    is invertible. Similarly, we have $\norm{\vf{S}_{\vf{\tilde{A}}}^{-1}\lambda_-}<1$ and so
    $$
      (\vf{S}_{\vf{\tilde{A}}}^{-1}-\lambda_-\vf{I})=\vf{S}_{\vf{\tilde{A}}}^{-1}\left(\vf{I}-\lambda_-\vf{S}_{\vf{\tilde{A}}}^{-1}\right)
    $$
    is invertible because it is a product of invertible operators. Thus, $\vf{L}_{\vf{\tilde{A}}}$ is invertible and its inverse is linear because $\vf{L}_{\vf{\tilde{A}}}$ is linear. Now, we return to our initial problem. Find $\vf{h}$ such that $\vf{h}= {\vf{L}_{\vf{\tilde{A}}}}^{-1}(\vf{b}(\vf{x}+\vf{h}(\vf{x})))=:\vf\Psi(\vf{h})$, which is a fixed-point problem. Note that $\vf\Psi$ is a contraction. Indeed:
    \begin{align*}
      \norm{\vf\Psi(\vf{h})-\vf\Psi(\vf{h}')} & \leq \norm{{\vf{L}_{\vf{\tilde{A}}}}^{-1}}\!\norm{\vf{b}(\vf{x}+\vf{h}(\vf{x}))\!-\!\vf{b}(\vf{x}+\vf{h}'(\vf{x}))} \\
                                              & \leq \norm{{\vf{L}_{\vf{\tilde{A}}}}^{-1}}\norm{\vf{Db}}\norm{\vf{h}-\vf{h}'}
    \end{align*}
    because of \mnameref{FSV:meanvaluethmvector}. This last term is arbitrarily small ($\norm{\vf{Db}}$ is arbitrarily small) because $\vf{B}$ is $\mathcal{C}^1$-close to $\vf{\tilde{A}}$. Thus, $\vf{h}$ exists and it's unique.
  \end{proof}
  \begin{definition}
    A dynamical system $f : X\rightarrow X$ has \emph{sensitive dependence on initial conditions} on $X$ if $\exists\varepsilon >0$ such that for each $x\in X$ and any neighborhood $N_x$ of $x$, exists $y \in N_x$ and $n \geq  0$ such that $d(f^n(x),f^n(y)) > \varepsilon$.
  \end{definition}
  \begin{definition}
    Let $U\subseteq \RR^n$, $\vf{f}:U\to U$ be a dynamical system and $\vf{x}\in U$ and $\vf{v}\in\RR^n$. We define the \emph{Lyapunov exponent} as:
    $$
      \chi(x,\vf{v}):=\limsup_{n\to\infty}\frac{1}{n}\log\norm{\vf{D}(\vf{f}^n)(x)\vf{v}}
    $$
  \end{definition}
  \begin{remark}
    The Lyapunov exponent measures the exponential growth rate of tangent vectors along orbits. It can rarely be computed explicitly, but if we can show that $\chi(x,\vf{v})>0$ for some $\vf{v}$, then we know that the system is \emph{chaotic}.
  \end{remark}
  \subsubsection{Hamiltonian systems}
  \begin{definition}
    Let $U\subseteq \RR^n\times \RR^n$ be open and $H:U\rightarrow \RR$ be a $\mathcal{C}^1$ function. We define the \emph{Hamiltonian vector field} associated to $H$ as:
    \begin{equation}\label{ADS:ham_system}
      \begin{cases}
        \displaystyle\dot{\vf{x}}=\pdv{H}{\vf{p}}\vspace{0.1cm} \\
        \displaystyle\dot{\vf{p}}=-\pdv{H}{\vf{x}}
      \end{cases}
    \end{equation}
  \end{definition}
  \begin{remark}
    Recall that $H$ is a first integral of the system \mcref{ADS:ham_system}.
  \end{remark}
  \begin{lemma}
    Let $H:U\rightarrow \RR$ be a $\mathcal{C}^1$ function, $W\subseteq U$. Then, the volume of $W$ under the field of \mcref{ADS:ham_system} is preserved.
  \end{lemma}
  \begin{proof}
    Let $W_t:=\vf{\phi}_t(W)$, where $\phi_t$ is the flow of \mcref{ADS:ham_system}. Then:
    \begin{equation*}
      \dv{}{t}\vol(W_t)=\dv{}{t}\int_{\phi_t(W)}\dd{\vf{x}}=\int_W\dv{}{t}\det \vf{D\phi}_t=\int_W\div \vf{X}_H
    \end{equation*}
    where $\vf{X}_H$ is the vector field of \mcref{ADS:ham_system}. But an easy computation shows that $\div \vf{X}_H=0$. Let's make the last step of the computation of above more explicit. Given $\vf{A}\in \GL_n(\RR)$, we have that:
    \begin{align*}
      \det(\vf{A} + \varepsilon \vf{T}) & = \varepsilon^n\det(\vf{A})\det\left(\frac{1}{\varepsilon} \vf{I} + \vf{T} \vf{A}^{-1}\right) \\
                                        & =\det(\vf{A})\left(1+\varepsilon\trace(\vf{T}\vf{A}^{-1})+\O{\varepsilon^2}\right)
    \end{align*}
    And so, $\det'(\vf{A})\vf{T}=\trace(\vf{T}\vf{A}^{-1})$. Finally, taking $\vf{A}=\vf{D\phi}_t$ and using that $\dv{}{t}\vf{D\phi}_t=\vf{DX}_H \vf{D\phi}_t$ we get:
    \begin{multline*}
      \dv{}{t}\det \vf{D\phi}_t=\det\empty{}'(\vf{D\phi}_t)\dv{}{t}\vf{D\phi}_t=\trace\!\left(\!\dv{}{t}\vf{D\phi}_t {(\vf{D\phi}_t)}^{-1}\!\right)=\\=\trace(\vf{DX}_H) = \div \vf{X}_H
    \end{multline*}
  \end{proof}
  \subsection{Dynamics on the circle}
  \subsubsection{Generalities}
  \begin{definition}
    Let $x,x'\in\RR$. We say that $x\sim x'$ if and only if $x-x'\in\ZZ$. We define the \emph{circle} as $\TT^1:=\quot{\RR}{\sim}$. We define the following distance in $\TT^1$:
    $$
      d(\overline{x},\overline{y})=\min_{x'\in\overline{x},y'\in\overline{y}}\abs{x'-y'}
    $$
  \end{definition}
  \begin{proposition}[Existence of a lift]\hfill
    \begin{enumerate}
      \item For any continuous map $F:\TT^1\to \TT^1$ there exists a \emph{lift} $f$, i.e.\ a continuous map $f:\RR\to \RR$ such that $F\circ \pi=\pi\circ f$, where $\pi:\RR\to\TT^1$ is the canonical projection.
      \item If $g$ is another lift of $F$, then $g-f=k\in\ZZ$.
    \end{enumerate}
  \end{proposition}
  \begin{proof}
    We only prove the second property. Since, $f$, $g$ are both lifts of $F$, they belong to the same equivalence class. Thus, $f-g\in\ZZ$. And now use the continuity of $f-g$.
  \end{proof}
  \begin{remark}
    Recall that a continuous function $f:\RR\to\RR$ is a homeomorphism if and only if $f$ is strictly monotonous.
  \end{remark}
  \begin{definition}
    We say that a homeomorphism $F$ \emph{preserves orientation} if and only if $f$ is strictly increasing. We define the set of $\Homeoplus(\TT^1)$ as the set of homeomorphisms of $\TT^1$ that preserve orientation.
  \end{definition}
  \begin{proposition}
    Let $F\in\Homeoplus(\TT^1)$. Then, $F$ admits a lift $f$ such that $f(x)=x+\varphi(x)$, where $\varphi:\RR\to\RR$ is a 1-periodic function.
  \end{proposition}
  \begin{proof}
    We already now that $F$ admits a lift $f$. A straightforward calculation shows that $f_1:\RR\to\RR$ defined by $f_1(x)=f(x+1)$ is also a lift of $F$. Thus, $f_1-f=k\in \ZZ$. Now, since $f$ must be strictly increasing, we need $k\in \NN$. Moreover, since $F$ is injective, $f|_{[0,1)}$ is injective and its image cannot contain 2 points whose difference is an integer. Thus, $k=1$. Now, define $\varphi(x)=f(x)-x$, which is 1-periodic:
    $$
      \varphi(x+1)=f(x+1)-(x+1)=f(x)-x=\varphi(x)
    $$
  \end{proof}
  \begin{definition}
    We define the set:
    \begin{multline*}
      \mathcal{D}^0(\TT^1):=\{f\in \Homeo(\RR):f\text{ increasing and}\\ f(x+1)=f(x)+1\}
    \end{multline*}
    Note that we have the projection:
    $$
      \function{}{\mathcal{D}^0(\TT^1)}{\Homeoplus(\TT^1)}{f}{F}
    $$
    We can define a distance in $\mathcal{D}^0(\TT^1)$ as:
    $$
      d(f,g)=\max\left\{ \sup_{x\in\RR}\abs{f(x)-g(x)},\sup_{x\in\RR}\abs{f^{-1}(x)-g^{-1}(x)}\right\}
    $$
  \end{definition}
  \begin{lemma}
    $\mathcal{D}^0(\TT^1)$ is a complete metric space. Moreover, the functions:
    $$
      \function{}{\mathcal{D}^0(\TT^1)}{\mathcal{D}^0(\TT^1)}{f}{f^{-1}}\quad
      \function{}{\mathcal{D}^0(\TT^1)\times \mathcal{D}^0(\TT^1)}{\mathcal{D}^0(\TT^1)}{(f,g)}{f\circ g}
    $$
    are continuous.
    Thus, $\mathcal{D}^0(\TT^1)$ is a topological group with the composition.
  \end{lemma}
  \begin{definition}
    Let $\varepsilon\geq 0$ and $\alpha\in\RR$. We define the \emph{Arnold family} as:
    $$
      \function{f_{\alpha,\varepsilon}}{\RR}{\RR}{x}{x+\alpha+\varepsilon\sin(2\pi x)}
    $$
  \end{definition}
  \begin{lemma}
    If $0\leq \varepsilon<\frac{1}{2\pi}$, then $f_{\alpha,\varepsilon}\in \mathcal{D}^0(\TT^1)$.
  \end{lemma}
  \begin{proof}
    Note that ${f_{\alpha,\varepsilon}}'>0\iff \varepsilon<\frac{1}{2\pi}$. Thus, $f_{\alpha,\varepsilon}$ is strictly increasing, and therefore it is a homeomorphism. Moreover, $f_{\alpha,\varepsilon}(x+1)=f_{\alpha,\varepsilon}(x)+1$.
  \end{proof}
  \subsubsection{Rotation number}\label{ADS:rotation_number_section}
  \begin{lemma}\label{ADS:lema_sum}
    Let $f=\id+\varphi\in\mathcal{D}^0(\TT^1)$ with $\varphi$ 1-periodic. Thus:
    $$
      f^n=\id + \sum_{i=0}^{n-1} \varphi\circ f^i=: \id + \varphi_n
    $$
    with $\varphi_n$ 1-periodic.
  \end{lemma}
  \begin{proof}
    Use induction on $i$ to prove that all the terms of the sum $\varphi\circ f^i$ are 1-periodic. The case $i=0$ is clear. Now, for the inductive step:
    \begin{multline*}
      \varphi\circ f^{i+1}(x+1)=\varphi\left(x+1+\sum_{k=0}^{i}\varphi\circ f^k(x+1)\right)=\\=\varphi\left( x+\sum_{k=0}^{i}\varphi\circ f^k(x)\right)=\varphi\circ f^{i+1}(x)
    \end{multline*}
  \end{proof}
  \begin{lemma}\label{ADS:lema1}
    Let $f=\id+\varphi\in\mathcal{D}^0(\TT^1)$ with $\varphi$ 1-periodic. Let $m:=\min_{x\in\RR}\varphi$ and $M:=\max_{x\in\RR}\varphi$. Then, we have $m\leq M< m+1$.
  \end{lemma}
  \begin{proof}
    By the periodicity and continuity of $\varphi$, we have that $\exists x_m, x_M\in\RR$ such that $\varphi(x_m)=m$, $\varphi(x_M)=M$ and $0\leq x_M-x_m<1$. Since $f\in \mathcal{D}^0(\TT^1)$, we must have $f(x_M)-f(x_m)<1$. Thus:
    $$
      M-m=f(x_M)-f(x_m)-(x_M-x_m)<1
    $$
  \end{proof}
  \begin{definition}
    Let ${(u_n)}\in\RR$ be a sequence. We say that $(u_n)$ is \emph{subadditive} if $u_{n+m}\leq u_n+u_m$ for all $n,m\in\NN$. We say that $(u_n)$ is \emph{superadditive} if $u_{n+m}\geq u_n+u_m$ for all $n,m\in\NN$, that is, if $(-u_n)$ is subadditive.
  \end{definition}
  \begin{lemma}\label{ADS:lema2}
    Let $f\in \mathcal{D}^0(\TT^1)$ be such that $f=\id +\varphi$. We can write $f^n=\id +\varphi_n$ and let $m_n:=\min_{x\in\RR}\varphi_n$ and $M_n:=\max_{x\in\RR}\varphi_n$. Then, $(M_n)$ is subadditive and $(m_n)$ is superadditive.
  \end{lemma}
  \begin{proof}
    We have that:
    \begin{equation*}
      f^{n+m}(x)-x=(f^m-\id)(f^n(x))+f^n(x)-x\leq M_m+M_n
    \end{equation*}
    Now take the supremum in $x$. The other inequality is analogous.
  \end{proof}
  \begin{lemma}\label{ADS:lema3}
    Let $(u_n)\in\RR$ be a subadditive sequence. Then, $\displaystyle\lim_{n\to\infty}\frac{u_n}{n}$ exists, and it is equal to $\displaystyle\inf_{n\in\NN}\frac{u_n}{n}$. Analogously, if $(u_n)$ is superadditive, then $\displaystyle\lim_{n\to\infty}\frac{u_n}{n}$ exists, and it is equal to $\displaystyle\sup_{n\in\NN}\frac{u_n}{n}$.
  \end{lemma}
  \begin{proof}
    Assume $(u_n)$ is subadditive and fix $p\in\NN$. Let $n\geq p$ be such that $n=k_np+r_n$ with $r<p$. Then:
    $$
      \frac{u_n}{n}\leq \frac{u_{k_np}+u_{r_n}}{n}\leq \frac{k_nu_p}{n}+\frac{u_{r_n}}{n}=\frac{u_p}{p+\frac{r_n}{k_n}}+\frac{u_{r_n}}{n}
    $$
    where in the first and second inequalities we used that $(u_n)$ is subadditive. Now to show that the limit exists and that the value is the one of above, take first $\limsup$ in $n$ and then $\inf$ in $p$:
    $$
      \limsup_{n\to\infty}\frac{u_n}{n}\leq \inf_{p\in\NN}\frac{u_p}{p}\leq \liminf_{p\to\infty}\frac{u_p}{p}
    $$
  \end{proof}
  \begin{theorem}[Existence of the rotation number]
    For all $f\in \mathcal{D}^0(\TT^1)$, we have that the sequence of functions $\frac{1}{n}(f^n-\id)$ convergence uniformly to constant function $\rho(f)\in\RR$. This number is called the \emph{rotation number} of $f$.
  \end{theorem}
  \begin{proof}
    By \mcref{ADS:lema1} we have that $\frac{m_n}{n}\leq \frac{M_n}{n}< \frac{m_n}{n}+\frac{1}{n}$, where $m_n:= \min_{x\in\RR}\varphi_n$ and $M_n:= \max_{x\in\RR}\varphi_n$. By \mcref{ADS:lema2,ADS:lema3}, we have that $\frac{m_n}{n}$ and $\frac{M_n}{n}$ have the same limit and moreover:
    $$
      \frac{m_n}{n}\leq \frac{1}{n}(f^n(x)-x)\leq \frac{M_n}{n}
    $$
    So we have the result, and in fact the convergence is uniform by domination.
  \end{proof}
  \begin{proposition}
    The following properties are satisfied:
    \begin{enumerate}
      \item $\rho(R_\alpha)=\alpha$ $\forall\alpha\in\RR$.
      \item $\rho(f^n)=n\rho(f)$ $\forall f\in \mathcal{D}^0(\TT^1)$, $n\in\NN$.
      \item $f\leq g\implies \rho(f)\leq \rho(g)$ $\forall f,g\in \mathcal{D}^0(\TT^1)$.
      \item $\rho(f+k)=\rho(f) + k$ $\forall f\in \mathcal{D}^0(\TT^1)$, $k\in\ZZ$.
      \item If $f,g\in \mathcal{D}^0(\TT^1)$ commute, then $\rho(f\circ g)=\rho(f)+\rho(g)$.
    \end{enumerate}
  \end{proposition}
  \begin{sproof}
    For the penultimate one, note that $f_k(x):=f(x+k)=f(x)+k$, since $f\in \mathcal{D}^0(\TT^1)$. Thus:
    $$
      {f_k}^n(x)=f(f(\cdots f(f(x+k)+k)+\cdots )+k)=f^n(x)+nk
    $$
  \end{sproof}
  \begin{proposition}
    The function
    $$
      \function{R}{\mathcal{D}^0(\TT^1)}{\RR}{f}{\rho(f)}
    $$
    is continuous with respect to the $\mathcal{C}^0$-topology.
  \end{proposition}
  \begin{proof}
    Let $\varepsilon >0$ and $N>0$ such that $\frac{1}{N}<\varepsilon$. Let $f,g\in \mathcal{D}^0(\TT^1)$ be close enough such that $\abs{f^N(x) - g^N(x)}<\varepsilon$ for all $x\in\RR$. In particular, $f^N(0)< g^N(0)+\varepsilon$. A straightforward induction shows that in fact we have $f^{kN}(0)< g^{kN}(0)+k-1+\varepsilon$ for all $k\in\NN$. Thus:
    $$
      \rho(f)-\rho(g)=\lim_{k\to\infty}\frac{f^{kN}(0)-g^{kN}(0)}{kN}\leq \frac{1}{N}<\varepsilon
    $$
    Exchanging the roles of $f$ and $g$ we get the other inequality.
  \end{proof}
  \begin{definition}
    Let $F\in \Homeoplus(\TT^1)$ with lift $f$. We define the \emph{rotation number} of $F$ as $\rho(F):=[\rho(f)]\in \TT^1$.
  \end{definition}
  \begin{definition}
    Let $F,G\in\Homeoplus(\TT^1)$. We say that $G$ is \emph{semi-conjugate} to $F$ if there exists a continuous surjective map $H:\TT^1\to \TT^1$ such that $H\circ F=G\circ H$. We say that $G$ is \emph{conjugate} to $F$ if $H$ is a homeomorphism.
  \end{definition}
  \begin{lemma}
    Let $F,G\in\Homeoplus(\TT^1)$ be such that $G$ is semi-conjugate to $F$. Then, if $F$ has a periodic point, then $G$ has a periodic point.
  \end{lemma}
  \begin{proof}
    Let $p\in \TT^1$ be a periodic point of $F$ with period $n$. Then, $H(p)$ is a periodic point of $G$ with period at most $n$. Indeed:
    $$
      G^n(H(p))=H(F^n(p))=H(p)
    $$
  \end{proof}
  \begin{remark}
    The converse is not true.
  \end{remark}
  \begin{theorem}\label{ADS:invariance_rho}
    Let $F,G\in\Homeoplus(\TT^1)$ be conjugate by $H\in \Homeoplus(\TT^1)$. Then, $\rho(F)=\rho(G)$.
  \end{theorem}
  \begin{proof}
    Let $h$ and $f$ be lifts of $H$ and $F$ respectively. Then, an easy check shows that $g:=h\circ f\circ h^{-1}$ is a lift of $G$. It suffices to prove that $\rho(g)=\rho(f)$. Note that, by induction we have $h\circ f^n=g^n\circ h$ for all $n\in\NN$. Now write $h=\id + \varphi$ with $\varphi\in \mathcal{C}(\TT^1)$. Then:
    \begin{equation*}
      \frac{f^n(x)-x+\varphi(f^n(x))}{n}= \frac{g^n(h(x))-h(x)}{n}+\frac{h(x)-x}{n}
    \end{equation*}
    Taking limits, we have that $\rho(f)=\rho(g)$, as $\varphi$ is bounded.
  \end{proof}
  \subsubsection{Rotation number and invariant measure}
  \begin{definition}
    We say that $\mu:\mathcal{C}(\TT^1)\to\RR$ is a \emph{measure on $\mathcal{C}(\TT^1)$} if:
    \begin{enumerate}
      \item $\mu$ is linear.
      \item $\mu$ is continuous.
      \item $\mu(\varphi)\geq 0$, whenever $\varphi\geq 0$.
    \end{enumerate}
    We say that $\mu$ is a \emph{probability measure} if $\mu(1)=1$. We denote by $\mathcal{M}(\TT^1)$ the set of all probability measures on $\mathcal{C}(\TT^1)$.
  \end{definition}
  \begin{remark}
    Usually we will denote $\mu(\varphi)$ by $\int_{\TT^1}\varphi\dd{\mu}$ or $\int_{\TT^1}\varphi(x)\dd{\mu(x)}$.
  \end{remark}
  \begin{remark}
    Note that we then have $\mu(\varphi)>0$ whenever $\varphi>0$, because $\varphi$ attains its minimum at some point $x_0$ (by the compactness of $\TT^1$). Similarly, $\mu(\varphi)\leq 0$ whenever $\varphi\leq 0$, and $\mu(\varphi)<0$ whenever $\varphi<0$.
  \end{remark}
  \begin{remark}
    Examples of such measures are the Dirac measures
    $$\delta_x(\varphi)=\varphi(x)\qquad x\in \TT^1$$
    or the Lebesgue measure:
    $$\text{Leb}(\varphi):=\int_{0}^1\varphi(x)\dd{x}$$
  \end{remark}
  \begin{definition}
    Let $F\in \Homeoplus(\TT^1)$ and $\mu\in \mathcal{M}(\TT^1)$. We define the \emph{push-forward measure} of $F$ as $F_*\mu(\varphi):=\mu(\varphi\circ F)$.
  \end{definition}
  \begin{definition}
    We say that a measure $\mu\in\mathcal{M}(\TT^1)$ is \emph{invariant} by $F\in\Homeo(\TT^1)$ (or \emph{$F$-invariant}) if $F_*\mu=\mu$. We will denote by $\mathcal{M}_F(\TT^1)$ the set of $F$-invariant probability measures.
  \end{definition}
  \begin{proposition}
    Let $F\in \Homeoplus(\TT^1)$, $x\in\TT^1$ and $n\in\NN$.
    \begin{enumerate}
      \item $\text{Leb}$ is invariant under $R_\alpha$ $\forall \alpha\in\RR$.
      \item $\delta_x$ is $F$-invariant $\iff F(x)=x$
      \item $\displaystyle\frac{\delta_x+\cdots+\delta_{F^{n-1}(x)}}{n}$ is $F$-invariant $\iff F^n(x)=x$
    \end{enumerate}
  \end{proposition}
  \begin{proof}
    We prove the difficult implication in the second item. That is, suppose $\delta_x$ is $F$-invariant. We then have that $\varphi(F(x))=\varphi(x)$ $\forall \varphi\in \mathcal{C}(\TT^1)$. Now if $F(x)\ne x$ for some $x\in \TT^1$, then we may assume $x < F(x)$ and consider a continuous function on $\TT^1$ that equals one in a neighborhood of $F(x)$ not containing $x$ and zero otherwise.
  \end{proof}
  \begin{theorem}
    Let $F\in\Homeoplus(\TT^1)$. Then, $\mathcal{M}_F(\TT^1)\ne\varnothing$.
  \end{theorem}
  \begin{proposition}
    Let $F\in\Homeo(\TT^1)$ and $f=\id+\varphi$ be a lift of $F$, with $\varphi\in\mathcal{C}(\TT^1)$. Then, $\forall\mu\in\mathcal{M}_F(\TT^1)$, $\rho(f)=\mu(\varphi)$. Moreover:
    \begin{enumerate}
      \item $\norm{f^n-\id -n\rho(f)}_{\mathcal{C}(\RR)}<1$ for all $n\in\NN$.
      \item $\forall n\in\NN$, $\exists x_n\in\RR$ such that $f^n(x_n)-x_n=n\rho(f)$.
    \end{enumerate}
  \end{proposition}
  \begin{proof}
    Let $\psi_n:= f^n-\id -n\mu(\varphi)$ with $\mu\in\mathcal{M}_F(\TT^1)$. We have that:
    \begin{multline*}
      \mu(\psi_n)=\sum_{i=0}^{n-1}\mu(\varphi\circ f^i)-n\mu(\varphi)=\sum_{i=0}^{n-1}\mu(\varphi\circ F^i)-n\mu(\varphi)=0
    \end{multline*}
    where we have used \mcref{ADS:lema_sum}. Now we must have that $\psi_n$ change their sign in $[0,1]$ because otherwise that would contradict $\mu(\psi_n)=0$. So $\exists x_n\in[0,1]$ such that $\psi_n(x_n)=0$. So:
    $$
      f^n(x_n)-x_n=n\mu(\varphi)
    $$
    Dividing by $n$ and taking limits, we have that $\rho(f)=\mu(\varphi)$. This also shows the second point. To prove the first one, note that $\min\psi_n\leq 0$ and so by \mcref{ADS:lema1} we have $\max\psi_n <1$. Moreover, $\min\psi_n =-\max(-\psi_n) >-1$ (using the same argument as before) and so $\norm{\psi_n}_{\mathcal{C}(\RR)}<1$ for all $n\in\NN$.
  \end{proof}
  \subsubsection{Rational rotation number}
  \begin{proposition}\label{ADS:characterisation_rot_number}
    Let $f\in \mathcal{D}^0(\TT^1)$, $p\in\ZZ$ and $q\in\NN$ be such that the fraction $\frac{p}{q}$ is irreducible. Then:
    \begin{align*}
      \rho(f)=\frac{p}{q} & \iff \exists x\in\RR\text{ such that }f^q(x)=x+p \\
      \rho(f)>\frac{p}{q} & \iff \forall x\in\RR\text{ we have }f^q(x)>x+p   \\
      \rho(f)<\frac{p}{q} & \iff \forall x\in\RR\text{ we have }f^q(x)<x+p
    \end{align*}
  \end{proposition}
  \begin{proof}
    Since $\rho(f^q)= q\rho(f)$ and $\rho(f+p)=\rho(f)+p$, we have that if $g=f^q-p$, $\rho(g)=q \rho(f)-p$. Thus, an easy check shows that we can assume that $p=0$ and $q=1$. We will only prove the equivalences to the left, as it is sufficient.
    \begin{enumerate}
      \item Assume $f(x)=x$ for some $x\in\RR$. Then, from the definition of $\rho(f)$ applied to the point $x$, we have that $\rho(f)=0$.
      \item Assume $f(x)>x$ and write $f=\id+\varphi$ with $\varphi\in\mathcal{C}(\TT^1)$ and $\varphi>0$. Since, $\TT^1$ is compact, we have in fact that $\varphi\geq \min\varphi=:\varepsilon>0$. Now:
            $$
              f^n-\id = \sum_{i=0}^{n-1}\varphi\circ f^i\geq n\varepsilon
            $$
            And so $\rho(f)\geq \varepsilon>0$.
      \item Proceed as in the previous case.
    \end{enumerate}
  \end{proof}
  \begin{definition}
    Let $F\in\Homeoplus(\TT^1)$ and $x\in \TT^1$. We define the \emph{orbit} of $x$ as:
    $$
      \mathcal{O}_F(x):=\{F^n(x):n\in\ZZ\}
    $$
    We also define the \emph{positive orbit} of $x$  and the \emph{negative orbit} of $x$ as:
    \begin{align*}
      \mathcal{O}_F^+(x) & :=\{F^n(x):n\in\ZZ_{\geq 0}\} \\
      \mathcal{O}_F^-(x) & :=\{F^n(x):n\in\ZZ_{\leq 0}\}
    \end{align*}
    If the homeomorphism is not specified, we will omit the subscript.
  \end{definition}
  \begin{definition}
    Let $F\in\Homeoplus(\TT^1)$ and $x\in \TT^1$. We define the \emph{omega limit} of $x$ as the set of limit points of $\mathcal{O}_F^+(x)$, i.e.:
    $$
      \omega(x):=\{y\in\TT^1:\exists (n_k)\nearrow+\infty\text{ such that }F^{n_k}(x)\to y\}
    $$
    We define the \emph{alpha limit} of $x$ as the set of limit points of $\mathcal{O}_F^-(x)$, i.e.:
    $$
      \alpha(x):=\{y\in\TT^1:\exists (n_k)\searrow-\infty\text{ such that }F^{n_k}(x)\to y\}
    $$
  \end{definition}
  \begin{definition}
    Let $F\in\Homeoplus(\TT^1)$ and $X\subset \TT^1$. We say that $X$ is \emph{positively invariant} if $F(X)\subseteq X$ and \emph{negatively invariant} if $F^{-1}(X)\subseteq X$. We say that $X$ is \emph{invariant} if $F(X)=X$.
  \end{definition}
  \begin{proposition}
    Let $X\subset \TT^1$ and $x\in \TT^1$. Then:
    \begin{enumerate}
      \item $X$ is invariant $\iff \forall x\in X$, $\mathcal{O}(x)\subseteq X\iff X$ is a union of orbits.
      \item $\mathcal{O}(x)$ is finite $\iff x$ is periodic.
      \item The omega limit $\omega(x)$ and the alpha limit $\alpha(x)$ are non-empty compact invariant sets.
    \end{enumerate}
  \end{proposition}
  \begin{definition}
    Let $F\in \Homeoplus(\TT^1)$. We define the \emph{positively recurrent points} and \emph{negatively recurrent points} as:
    \begin{align*}
      R^+(F):=\{x\in\TT^1:x\in\omega(x)\} \\
      R^-(F):=\{x\in\TT^1:x\in\alpha(x)\}
    \end{align*}
  \end{definition}
  \begin{proposition}
    Let $F\in \Homeoplus(\TT^1)$. Then, $R^\pm(F)$ are invariant non-closed sets.
  \end{proposition}
  \begin{definition}
    Let $F\in \Homeoplus(\TT^1)$ and $x\in \TT^1$. We say that $x$ is a \emph{wandering point} if there exists a neighborhood $U$ of $x$ such that $\forall n\geq 1$ we have $F^n(U)\cap U=\varnothing$. The neighborhood $U$ is called a \emph{wandering domain}. We define the set:
    $$
      \Omega(F):=\{ x\in\TT^1: x\text{ is not wandering}\}
    $$
  \end{definition}
  \begin{remark}
    A point $x\in\TT^1$ is \emph{non-wandering} if it is not wandering, i.e.\ if $\forall U$ neighborhood of $x$ $\exists n\geq 1$ such that $F^n(U)\cap U\ne\varnothing$.
  \end{remark}
  \begin{proposition}
    Let $F\in \Homeoplus(\TT^1)$. Then, $\Omega(F)$ is an invariant closed set.
  \end{proposition}
  \begin{lemma}
    Let $F \in \Homeoplus(\TT^1)$. Then:
    $$
      \Fix(F)\subseteq \Per(F)\subseteq R^\pm(F)\subseteq \Omega(F)\subseteq \TT^1
    $$
  \end{lemma}
  \begin{proof}
    All the inclusions are clear except for maybe $R^\pm(F)\subseteq \Omega(F)$. Let $x\in R^\pm(F)$. Then, $\exists (n_k)\in\NN$ with $n_k \nearrow \infty$ such that $F^{n_k}(x)\to x$. Now, let $U$ be a neighborhood of $x$. Then, $x\in U$ and for $k$ large enough, by the continuity of $F$, we must have $x\in F^{n_k}(U)$. So $F^{n_k}(U)\cap U\ne\varnothing$ and thus $x\in \Omega(F)$.
  \end{proof}
  \begin{definition}
    Let $F\in \Homeoplus(\TT^1)$ and $X\subseteq \TT^1$ be a non-empty closed invariant set. We say that $X$ is \emph{minimal} if $\forall x\in X$, $\overline{\mathcal{O}(x)}=X$. If $X=\TT^1$, we say that $F$ is \emph{minimal}.
  \end{definition}
  \begin{proposition}
    Let $F\in \Homeoplus(\TT^1)$ and $X\subseteq \TT^1$ be a closed and invariant. Then, $X$ is minimal $\iff$ $\forall Y\subseteq X$ closed, invariant and non-empty, $Y=X$.
  \end{proposition}
  \begin{proof}
    \begin{itemizeiff}
      Let $Y\subseteq X$ be closed, invariant and non-empty and take $y\in Y$. We have:
      $$Y\subseteq X = \overline{\mathcal{O}(y)}\subseteq \overline{Y}=Y$$
      \item Let $x\in X$. Since $\overline{\mathcal{O}(x)}\subseteq X$ is closed, invariant and non-empty, we have that $\overline{\mathcal{O}(x)}=X$.
    \end{itemizeiff}
  \end{proof}
  \begin{theorem}
    Let $F\in \Homeoplus(\TT^1)$ with $\rho(F)=\frac{p}{q}\in \quot{\QQ}{\ZZ}$. Then:
    \begin{enumerate}
      \item $F$ has periodic points of period $q$, and any periodic point of $F$ has minimal period $q$.
      \item For any $x\in \TT^1$, $\omega(x)$ and $\alpha(x)$ are periodic orbits.
    \end{enumerate}
  \end{theorem}
  \begin{proof}
    First we assume $q=1$ and $p=0$. Let $f\in \mathcal{D}^0(\TT^1)$ be a lift of $F$. By \mcref{ADS:characterisation_rot_number}, we have that $\exists x\in \RR$ with $f(x)=x$. So $\Fix(f)\ne \varnothing$, and it is closed and invariant by integer translations. Now we write $\RR\setminus\Fix(f)$ as union of open intervals. Let $(a,b)$ be one of such connected components. Inside it, we must have either $f(x)>x$ or $f(x)<x$. In the first case we have that $(f^n(x))$ is strictly increasing $\forall x\in (a,b)$ and so $\omega(x)=\{b\}\in\Fix(f)$ and $\alpha(x)=\{a\}\in\Fix(f)$ $\forall x\in(a,b)$. The second case is exactly the opposite.

    Now we do the general case. Assume $\rho(f)=\frac{p}{q}$. Then, again by \mcref{ADS:characterisation_rot_number}, we have that $\exists x\in \RR$ with $f^q(x)=x+p$. Assume we have $x'\in\RR$ and $p',q'\in\ZZ$ with $q'\geq 1$ such that $f^{q'}(x')=x'+p'$. By \mcref{ADS:characterisation_rot_number}, we have that $\frac{p}{q}=\frac{p'}{q'}$ and so $\exists k\in\NN$ such that $q'=kq$ and $p'=kp'$ because $\frac{p}{q}$ is irreducible. Now let $g=f^q-p$. Then, an easy calculation shows that $g^k(x')=x'$. But $\rho(g)=0$ and in the previous case we have seen that the periodic points are only fixed points, so $k=1$. For the second part, we proceed as in the previous case with the function $g=f^q-p$.
  \end{proof}
  \subsubsection{Irrational rotation number}
  \begin{definition}
    Given $\mu\in \mathcal{M}(\TT^1)$ and $U\subseteq \TT^1$ open, we define the \emph{measure of $U$} as:
    $$
      \mu(U):=\sup\{\mu(\varphi):\varphi\in\mathcal{C}(\TT^1),\varphi\leq \indi{U}\}
    $$
    Let $A\subset \mathcal{B}(\TT^1)$ be a Borel measurable set. We define the \emph{measure of $A$} as:
    $$
      \mu(A):=\inf\{\mu(U):A\subseteq U, U\text{ open}\}
    $$
  \end{definition}
  \begin{remark}
    With this definition we have the usual properties of measure defined on subsets of $\TT^1$. In particular, $\text{Leb}([a,b])=b-a$ and $\delta_x(A)=\indi{x\in A}$ $\forall x\in \TT^1$ and $A\subseteq \TT^1$.
  \end{remark}
  \begin{definition}
    Let $\mu\in \mathcal{M}(\TT^1)$. We define the \emph{support of $\mu$} as:
    $$
      \supp\mu:=\{x\in\TT^1:\forall U\subseteq \TT^1\text{ open with } x\in U,\mu(U)>0\}
    $$
  \end{definition}
  \begin{remark}
    Note that $\supp\mu $ is a closed set and $\mu(\TT^1\setminus \supp\mu) = 0$.
  \end{remark}
  \begin{remark}
    If $F\in \Homeoplus(\TT^1)$ and $\mu\in \mathcal{M}_F(\TT^1)$, then $\supp\mu$ is invariant.
  \end{remark}
  \begin{remark}
    $\supp\text{Leb}=\TT^1$ and $\supp\delta_{x}=\{x\}$.
  \end{remark}
  \begin{proposition}
    Let $\mu\in \mathcal{M}(\TT^1)$ and $F\in\Homeo(\TT^1)$. $\mu$ is invariant by $F$ if and only if $\forall A\subseteq \TT^1$ Borel set, $\mu(A)=\mu(F^{-1}(A))$.
  \end{proposition}
  \begin{proof}
    \begin{itemizeiff}
      Let $A\subseteq \TT^1$ be Borel. We have:
      \begin{multline*}
        \mu(A) =\!\inf_{\substack{U\text{ open} \\A\subseteq U}}\sup_{\substack{\psi\text{ cont.}\\\varphi\leq \indi{U}}}\!\mu(\varphi)=\!\inf_{\substack{U\text{ open} \\A\subseteq U}}\sup_{\substack{\psi\text{ cont.}\\\varphi\leq \indi{U}}}\!\mu(\varphi\circ F)=\\
        =\inf_{\substack{U\text{ open} \\A\subseteq U}}\sup_{\substack{\psi\text{ cont.}\\\psi\leq \indi{F^{-1}(U)}}}\!\mu(\psi)=\!\inf_{\substack{V\text{ open} \\F^{-1}(A)\subseteq V}}\sup_{\substack{\psi\text{ cont.}\\\psi\leq \indi{V}}}\mu(\psi)=\\=\mu(F^{-1}(A))
      \end{multline*}
      % \item Now, let $\varphi\in \mathcal{C}(\TT^1)$. Note that:
    \end{itemizeiff}
  \end{proof}
  \begin{remark}
    If $F\in \Homeoplus(\TT^1)$ and $\mu\in\mathcal{M}_F(\TT^1)$, then $\mu(F^n(A))=\mu(A)$ $\forall n\in\ZZ$ and $A\subseteq \TT^1$ Borel.
  \end{remark}
  \begin{lemma}
    Let $\mu\in \mathcal{M}(\TT^1)$. We have a lift to a measure $\mu$ on $\RR$ invariant by integer translations: $\mu(A+k)=\mu(A)$ $\forall k\in\ZZ$ and $A\subseteq \mathcal{B}(\RR)$.
  \end{lemma}
  \begin{definition}
    Let $\mu\in\mathcal{M}(\TT^1)$. We define $h_\mu:[0,1]\to [0,1]$ as the function with $h_\mu(0)=0$ and $h_\mu(x)=\mu([0,x))$ for $0<x\leq 1$. This definition extends to a non-decreasing function $h_\mu:\RR\to\RR$ such that $h_\mu(x+k)=h_\mu(x)+k$ $\forall k\in\ZZ$.
  \end{definition}
  \begin{definition}
    Let $\mu\in\mathcal{M}(\TT^1)$. We say that $\mu$ has atoms if $\exists x\in\TT^1$ such that $\mu(\{x\})>0$.
  \end{definition}
  \begin{lemma}\label{ADS:lemma_atom}
    Let $\mu\in\mathcal{M}(\TT^1)$. $h_\mu$ is continuous if and only if $\forall x\in\RR$, $\mu(\{x\})=0$, that is if $\mu$ has no atoms.
  \end{lemma}
  \begin{proof}
    \begin{itemizeiff}
      Let $x_n=x+\frac{1}{n}\to x$. Then, $[0,x_n)\supset [0,x_{n+1})$ and so by the continuity of $h_\mu$ and \mcref{RFA:decresingseq} we have:
      \begin{multline*}
        \mu([0,x))=\lim_{n\to\infty}\mu([0,x_n))=\mu\left(\bigcap_{n\in\NN}[0,x_n)\right)=\\=\mu([0,x])
      \end{multline*}
      which implies that $\mu(\{x\})=0$.
      \item Let $x\in\RR$ and $x_n\to x$. Since $(x_n)$ is bounded, we can extract a monotone subsequence $(x_{n_k})$. Then:
      \begin{multline*}
        \lim_{n\to \infty}h(x_n)=\lim_{k\to \infty}\mu([0,x_{n_k}))=\\
        =\begin{cases}
          \mu\left(\bigcup_{k\in\NN}[0,x_{n_k})\right) = \mu([0,x)) & \text{if } x_{n_k}\nearrow x \\
          \mu\left(\bigcap_{k\in\NN}[0,x_{n_k})\right) = \mu([0,x]) & \text{if } x_{n_k}\searrow x
        \end{cases}
      \end{multline*}
      The first case is fine, and for the second one, since $\mu(\{x\})=0$, we have that $\mu([0,x])=\mu([0,x))$.
    \end{itemizeiff}
  \end{proof}
  \begin{definition}
    A subset $C\subseteq \RR$ is a \emph{Cantor set} if it is closed, it has no isolated points and it has empty interior.
  \end{definition}
  \begin{theorem}\label{ADS:theorem_irrational_rotation_number}
    Let $F\in\Homeoplus(\TT^1)$ with $\rho(F)\notin\quot{\QQ}{\ZZ}$. Then, there exists a surjective continuous map $H:\TT^1\to \TT^1$ such that $H\circ F=R_{\rho(F)}\circ H$. Moreover, we have exactly one of the following two properties:
    \begin{enumerate}
      \item $F$ is conjugated to $R_{\rho(F)}$ and in that case $F$ is minimal.
      \item $\exists X\subsetneq \TT^1$ minimal which is a Cantor set and $X=\Omega(F)$.
    \end{enumerate}
  \end{theorem}
  \begin{proof}
    Let $\mu\in\mathcal{M}_F(\TT^1)$ and consider $h:=h_\mu:\RR\to\RR$ as defined above. Now assume $x\in \TT^1$ is such that $\mu(\{x\})=c>0$, then by invariance $\mu(A_n)=c>0$, where $A_n:=\{F^n(x)\}$. Note that since $\mu\leq 1$, $(A_n)$ cannot be disjoint. So $\exists n,m\in\NN$ with $n<m$ such that $F^n(x)=F^m(x)$. But then $F^{m-n}(x)=x$ and so $x$ is periodic, which is not possible since $\rho(F)\in\quot{\QQ}{\ZZ}$ by \mcref{ADS:characterisation_rot_number}. Thus, $\mu$ has no atoms and so $h$ is continuous by \mcref{ADS:lemma_atom}. Now, define $H:\TT^1\to \TT^1$ as the projection of $h$ to $\TT^1$, which is continuous and surjective. Let $f\in\mathcal{D}^0(\TT^1)$ be a lift of $F$. Then:
    $$
      h(f(x))-h(f(0))=\mu([f(0),f(x)))=\mu([0,x))=h(x)
    $$
    where we have used the invariance of $\mu$. Thus, $h\circ f=R_{h(f(0))}\circ h$ and necessarily we need $h(f(0))=\rho(R_{h(f(0))})=\rho(f)$. This gives $H\circ F=R_{\rho(F)}\circ H$. Now, we can express the dichotomy as follows: either $\supp\mu=\TT^1$ or $\supp\mu=:X\subsetneq \TT^1$. The first case is equivalent to $h$ being strictly increasing and so $h$ is a homeomorphism. Then, $H$ conjugates $F$ and $R_{\rho(F)}$ and so $F$ is minimal because $R_{\rho(F)}$ is minimal. In the second case, we have that $X$ is a nonempty closed invariant set that has no isolated points because $\mu$ has no atoms. To show that $X$ is minimal, let $\TT^1=X\sqcup U$ with $U$ open, and so it can be written as a countable union of open intervals. Let $D\subseteq X$ be the set containing the endpoints of those intervals and let
    \begin{equation}\label{ADS:eq1}
      Y:=\{y\in\TT^1:H^{-1}(\{y\})\text{ is a closed interval}\}
    \end{equation}
    $Y$ is countable ($H^{-1}(Y)=U\cup D$). Now take $M\subseteq X$ be nonempty, closed and invariant. We want to prove that $M=X$. We have that $H(M)\subseteq \TT^1$ is nonempty, closed (in fact it's compact because it is the image of a compact set) and invariant by $R_{\rho(F)}$. So $H(M)=\TT^1$ because $R_{\rho(F)}$ is minimal. Now, since $H$ restricted to $X\setminus D$ is injective ($h$ is strictly increasing in $X\setminus D$ thought inside $[0,1]$), then $M\supseteq X\setminus D$ because if not there would exist $x\in X\setminus D$ such that $x\notin M$. We have $H(X\setminus D)=\TT^1\setminus Y$. Thus, $H^{-1}(H(X\setminus D))=H^{-1}(\TT^1\setminus Y)=X\setminus D$. Then, $H(x)\in H(X\setminus D)\subseteq \TT^1=H(M)$. So $\exists y\in M$ such that $H(x)=H(y)$, and so $y\in H^{-1}(H(X\setminus X))=X\setminus D$. But $H|_{X\setminus D}$ is injective, so $x=y\in M$, which is a contradiction because $x\notin M$. Thus, $M\supseteq X\setminus D$, which implies:
    $$
      M=\overline{M}\supseteq \overline{X\setminus D}=\overline{X} = X
    $$
    So $M=X$ and, thus, $X$ is minimal. Moreover, $X$ has empty interior. Indeed, if that wasn't the case, we would have $\Fr{X}=\overline{X}\setminus\Int(X)=X\setminus \Int(X)\subsetneq X$ and so $\Fr{X}$ would be a nonempty closed invariant set, which is not possible because $X$ is minimal. Finally, to prove $X=\Omega(F)$, by minimality it suffices to show that $\Omega(F)\subseteq X$. Let $x\in U$, where $\TT^1=X\sqcup U$, with $U=\bigsqcup_{i=1}^\infty I_i$ invariant and $I_i$ intervals. Note that $F$ maps connected components of $U$ to connected components of $U$. We need to see that $x$ is wandering. Let $I$ be one of such intervals. We may have either $F^n(I)=I$ for some $n\geq 1$ or $F^n(I)\cap I=\varnothing$ for all $n\geq 1$. But in the first case, we would have that the extremities of $I$ are periodic points, which is not possible because $\rho(F)\notin\quot{\QQ}{\ZZ}$. So we must have the second case, which implies that $I$ is a wandering domain, and thus so is $U$.
  \end{proof}
  \subsubsection{Unique ergodicity}
  \begin{definition}
    A homeomorphism $F:\TT^1\to\TT^1$ is \emph{uniquely ergodic} if it has a unique invariant probability measure.
  \end{definition}
  \begin{lemma}
    If $\alpha\notin \QQ$, then $R_\alpha$ is uniquely ergodic and $\mathcal{M}_{R_\alpha}(\TT^1)=\{\text{Leb}\}$.
  \end{lemma}
  \begin{proof}
    Let $\mu\in\mathcal{M}_{R_\alpha}$. We want to see that $\forall \varphi\in \mathcal{C}(\TT^1)$:
    $$
      \int_{\TT^1}\varphi(x)\dd{\mu}=\int_{\TT^1}\varphi(x)\dd{x}
    $$
    An easy check shows that if $P_n=\sum_{k=-n}^na_k\exp{2\pi\ii k x}$ is a trigonometric polynomial, then $\int_{\TT^1}P_n(x)\dd{x}=a_0$. Moreover, if $k\ne 0$:
    $$
      \int_{\TT^1}\exp{2\pi\ii kx}\dd{\mu}=\exp{2\pi\ii k\alpha}\int_{\TT^1}\exp{2\pi\ii kx}\dd{\mu}\implies \int_{\TT^1}\exp{2\pi\ii kx}\dd{\mu}=0
    $$
    where the equality is due to the invariance of $\mu$. So, we also have $\int_{\TT^1}P_n(x)\dd{\mu}=a_0$. Now consider the FÃ©jer means, which converge uniformly to $\varphi$ (recall \mnameref{MA:fejerthm}) and use the \mcref{MA:uniformintegral}.
  \end{proof}
  \begin{proposition}\label{ADS:uniquely_ergodic}
    Let $F\in\Homeoplus(\TT^1)$ with $\rho(F)\notin\quot{\QQ}{\ZZ}$. Then, $F$ is uniquely ergodic.
  \end{proposition}
  \begin{proof}
    Let $H$ be such that $H\circ F=R_{\rho(F)}\circ H$ (by \mcref{ADS:theorem_irrational_rotation_number}) and so $F^{-1}(H^{-1}(A))=H^{-1}({R_{\rho(F)}}^{-1}(A))$. Take $\mu\in\mathcal{M}_F(\TT^1)$ and define $H_*\mu$ as:
    $$
      H_*\mu(A):=\mu(H^{-1}(A))\qquad \forall A\subseteq \TT^1\text{ Borel}
    $$
    We have:
    \begin{multline*}
      H_*\mu(A)=\mu(H^{-1}(A))=\mu(F^{-1}(H^{-1}(A)))=\\=\mu(H^{-1}({R_{\rho(F)}}^{-1}(A)))=H_*\mu({R_{\rho(F)}}^{-1}(A))
    \end{multline*}
    where the second equality is due to the invariance of $\mu$. Hence, $H_*\mu$ is invariant by $R_{\rho(F)}$, and so $H_*\mu=\text{Leb}$. That, is $\mu(H^{-1}(A))=\text{Leb}(A)$. Recall again the set $Y$ of \mcref{ADS:eq1} and $\TT^1=X\sqcup U$, with $H^{-1}(Y)=\overline{U}$. Since $Y$ is countable, $0=\text{Leb}(Y)=\mu(H^{-1}(Y))$. Now since $H|_{X\setminus D}:X\setminus D\to \TT^1\setminus Y$ is a homeomorphism, we have that $\mu(B)=\text{Leb}(H(B))$, and so $\mu$ is uniquely determined.
  \end{proof}
  \begin{proposition}\label{ADS:birkov_sum_converge}
    Let $F\in \Homeo(\TT^1)$. Then, $F$ is uniquely ergodic if and only if $\forall \varphi\in\mathcal{C}(\TT^1)$, $\exists c_\varphi\in\RR$ such that $\frac{1}{n}\sum_{i=0}^{n-1}\varphi\circ F^i$ converge uniformly to $c_\varphi$. In that case, $c_\varphi=\mu(\varphi)$, where $\mathcal{M}_F(\TT^1)=\{\mu\}$.
  \end{proposition}
  \begin{proof}
    Assume first that $\mathcal{M}_F(\TT^1)=\{\mu\}$ and argue by contradiction. That, is $\exists \varepsilon>0$, $(n_k)\in\NN$ with $n_k\nearrow +\infty$ and $(x_k)\in\TT^1$ such that $\forall k\geq 0$:
    \begin{equation}\label{ADS:nuk_mu}
      \abs{\frac{1}{n_k}\sum_{i=0}^{n_k-1}\varphi\circ F^i(x_k)-\int_{\TT^1}\varphi\dd{\mu}}=\abs{\int_{\TT^1}\varphi\dd{\nu_k}-\int_{\TT^1}\varphi\dd{\mu}}>\varepsilon
    \end{equation}
    $$
    $$
    where $\nu_k=\frac{1}{n_k}\sum_{i=0}^{n_k-1}{(F^i)}_*\delta_{x_k}$. Note that $\nu_k\in\mathcal{M}(\TT^1)$ and since $\mathcal{M}(\TT^1)$ is compact with the weak$^*$-topology\footnote{$\mathcal{M}(\TT^1)$ is closed in $E=(\mathcal{C}(\TT^1))^*$ and it's contained in the unit ball of $E$, which is compact for the weak$^*$-topology. Thus, $\mathcal{M}(\TT^1)$ is compact.}, after extracting a subsequence, $(\nu_k)$ converges weakly to $\nu\in\mathcal{M}(\TT^1)$. Now, $\nu$ is invariant. Indeed:
    $$
      \norm{F_*\nu_k-\nu_k}=\norm{\frac{1}{n_k}({(F^{n_k})}_*\delta_{x_k}-\delta_{x_k})}\leq \frac{
        2\norm{\varphi}}{n_k}\overset{k\to\infty}{\longrightarrow} 0
    $$
    So $\nu =\mu$, but this is a contradiction with \mcref{ADS:nuk_mu}. Now we prove the converse. Let $\mu\in\mathcal{M}_F(\TT^1)$. Then:
    \begin{multline*}
      c_\varphi =\int_{\TT^1}c_\varphi\dd{\mu} =\int_{\TT^1}\lim_{n\to\infty}\frac{1}{n}\sum_{i=0}^{n-1}\varphi\circ F^i\dd{\mu} =\\
      =\lim_{n\to\infty}\frac{1}{n}\sum_{i=0}^{n-1}\int_{\TT^1}\varphi\circ F^i\dd{\mu}=\lim_{n\to\infty}\frac{1}{n}\sum_{i=0}^{n-1}\int_{\TT^1}\varphi\dd{\mu} =\int_{\TT^1}\varphi\dd{\mu}
    \end{multline*}
    where the third equality is due to the uniform convergence and the penultimate equality is due to the invariance of $\mu$. This implies that $\mu$ is uniquely determined.
  \end{proof}
  \begin{remark}
    The unique ergodicity property is preserved under conjugation.
  \end{remark}
  \begin{definition}
    For $k\in\NN\cup\{0\}$ we define the set $\mathcal{D}^k(\TT^1)$ as:
    \begin{multline*}
      \mathcal{D}^k(\TT^1):=\{f:\RR\to\RR \text{ increasing $\mathcal{C}^k$-diffeomorphism}\\\text{such that }f(x+1)=f(x)+1\}
    \end{multline*}
    Note that $f\in \mathcal{D}^k(\TT^1)$ if and only if $f=\id +\varphi$, with $\varphi\in\mathcal{C}^k(\TT^1)$.
    We also define the set $\Diffplus^k(\TT^1)$ as:
    \begin{multline*}
      \Diffplus^k(\TT^1):=\{F:\TT^1\to\TT^1 \text{ $\mathcal{C}^k$-diffeomorphism with}\\\text{orientation preserving}\}
    \end{multline*}
  \end{definition}
  \begin{proposition}
    Let $F\in\Diffplus^1(\TT^1)$ with $\rho(F)\notin\quot{\QQ}{\ZZ}$, $\mu$ be the unique invariant probability measure of $F$ and $f\in\mathcal{D}^1(\TT^1)$ be a lift of $F$. Then, $\displaystyle \lim_{n\to \infty}\frac{1}{n}\log Df^n(x)=\int_{\TT^1}\log(Df)\dd{\mu}=0$.
  \end{proposition}
  \begin{proof}
    An easy induction shows that $\forall n\in\NN$ we have:
    $$
      \log Df^n=\sum_{i=0}^{n-1}\log(Df\circ f^i)
    $$
    So:
    $$
      \frac{1}{n}\log Df^n=\frac{1}{n}\sum_{i=0}^{n-1}\log(Df\circ f^i)=\frac{1}{n}\sum_{i=0}^{n-1}\log(Df\circ F^i)
    $$
    where in the last equality we have used the fact that $Df=1+D\varphi\in \mathcal{C}(\TT^1)$. By \mcref{ADS:uniquely_ergodic,ADS:birkov_sum_converge}, we have that $\frac{1}{n}\sum_{i=0}^{n-1}\log(Df\circ F^i)$ converges uniformly to $c:=\int_{\TT^1}\log(Df)\dd{\mu}$. Moreover, since $Df^n=1+D\varphi_n\in \mathcal{C}(\TT^1)$, we have that $\int_{\TT^1}Df^n\dd{x} =1+\int_{\TT^1}D\varphi_n\dd{x}=1$. Now assume without loss of generality that $c>0$. Then, for $n$ large enough we must have $Df^n(x)\sim e^{nc}$ and so:
    $$
      1=\int_{\TT^1}Df^n\dd{x}\sim \int_{\TT^1}e^{nc}\dd{x}\overset{n\to\infty}{\longrightarrow} +\infty
    $$
    If $c<0$, we have a similar contradiction. Thus, $c=0$.
  \end{proof}
  \begin{definition}
    Let $\varphi\in\mathcal{C}(\TT^1)$. We say that $\varphi$ has \emph{bounded variation} if $\exists C\geq 0$ such that for all $0=x_0<x_1<\dots<x_n=1$ we have:
    $$
      \sum_{i=1}^n\abs{\varphi(x_i)-\varphi(x_{i-1})}\leq C
    $$
    The constant $C$ is usually denoted as $\Var(\varphi)$.
  \end{definition}
  \begin{remark}
    If $\varphi\in\mathcal{C}^1(\TT^1)$, then $\Var(\varphi)=\norm{D\varphi}_{\mathcal{C}^0}$.
  \end{remark}
  \begin{lemma}\label{ADS:lema_pnqn}
    Let $\alpha\notin\QQ$. Then, $\forall n\in\NN$, $\exists \frac{p_n}{q_n}\in\QQ$ such that:
    \begin{enumerate}
      \item $\displaystyle\abs{\alpha-\frac{p_n}{q_n}}<\frac{1}{{q_n}^2}$
      \item $q_n\overset{n\to\infty}{\longrightarrow}+\infty$
    \end{enumerate}
  \end{lemma}
  \begin{proof}
    Let $Q\in\NN$. By the Pigeon-hole principle, there exist two elements among $0,\{\alpha\},\ldots,\{Q \alpha\}$ (here $\{\cdot\}$ denotes the fractional part) such that they are in one of the intervals among $\left[0,\frac{1}{Q}\right], \left[\frac{1}{Q},\frac{2}{Q}\right],\ldots,\left[\frac{Q-1}{Q},1\right]$. That is, $\exists q_1,q_2\in\QQ_{\geq 0}$ and $p\in\ZZ$ such that $\abs{q\alpha -p}\leq \frac{1}{Q}$ with $q:=q_2-q_1\leq Q$. Now apply this to $Q_n=n\geq 1$: $\exists \frac{p_n}{q_n}\in \QQ$ with $1\leq q_n\leq n$ such that:
    $$
      \abs{q_n\alpha-p_n}<\frac{1}{n}\leq \frac{1}{q_n}
    $$
    To prove that $q_n\overset{n\to\infty}{\longrightarrow}+\infty$, we argue by contradiction. Assume that $\exists M\in\NN$ such that $q_n\leq M$ for all $n\in\NN$. Then, $\exists n_0\in\NN$ such that $\forall n\geq n_0$ we have $q_n=q_{n_0}$. But then by the irrationality of $\alpha$ we have that $\exists c>0$ such that:
    $$
      c\leq \abs{q_n\alpha-p_n}\leq \frac{1}{n} \overset{n\to\infty}{\longrightarrow} 0
    $$
    which is a contradiction.
  \end{proof}
  \begin{lemma}\label{ADS:lema_alpha_i}
    Let $\alpha\notin\QQ$ and $\frac{p}{q}\in \QQ$ with $\abs{\alpha-\frac{p}{q}}<\frac{1}{q^2}$. Set $\alpha_i:=\{i\alpha\}$ for $1\leq i\leq q$, where $\{x\}$ denotes the fractional part of $x$. Then, each $\alpha_i$ belongs to a different interval of the form $\left(\frac{k_i}{q},\frac{k_i+1}{q}\right)$ with $k_i\in\{0,\ldots,q-1\}$.
  \end{lemma}
  \begin{proof}
    Assume without loss of generality that $0<\alpha-\frac{p}{q}<\frac{1}{q^2}$. Then, for $1\leq i\leq q$ we have:
    \begin{equation}\label{ADS:ineq_alpha_i}
      0\leq i\alpha -\frac{ip}{q}<\frac{i}{q^2}\leq \frac{1}{q}
    \end{equation}
    We claim that the numbers $\{i \frac{p}{q}\}$ are all distinct for $1\leq i\leq q$. Indeed, if $\exists i,j$ with $i\frac{p}{q} -j\frac{p}{q}=k\in\ZZ^*$, then $\frac{p}{q}=\frac{k}{i-j}$, which is not possible because $\frac{p}{q}$ is irreducible and $i-j \leq q-1$. So we can write $\{i \frac{p}{q}\}=k_i\frac{p}{q}$ for some $k_i\in\{0,\ldots,q-1\}$. Finally, \mcref{ADS:ineq_alpha_i} implies that $\alpha_i\in \left(\frac{k_i}{q},\frac{k_i+1}{q}\right)$.
  \end{proof}
  \begin{proposition}[Denjoy-Koksma inequality]\label{ADS:denjoy_koksma}
    Let $F\in\Homeoplus(\TT^1)$ with $\alpha:=\rho(F)\notin \quot{\QQ}{\ZZ}$, $\mu\in\mathcal{M}_F(\TT^1)$ and $\frac{p}{q}\in \QQ$ with $\abs{\alpha-\frac{p}{q}}<\frac{1}{q^2}$. Then, $\forall\psi\in \mathcal{C}(\TT^1)$ with $\Var(\psi)<\infty$ we have:
    $$
      \abs{\sum_{i=0}^{q-1}\psi(F^i(x))-q\int_{\TT^1}\psi\dd{\mu}}\leq\Var(\psi) \qquad \forall x\in \TT^1
    $$
  \end{proposition}
  \begin{proof}
    We'll prove that $\forall x\in \TT^1$:
    $$
      \abs{\sum_{i=1}^q \psi(F^i(x))-q\int_{\TT^1}\psi\dd{\mu}}\leq \Var(\psi)
    $$
    which is equivalent by replacing $x$ by $F^{-1}(x)$.
    Let $x\in \TT^1$ and choose $y_1,\ldots,y_{q-1}\in \TT^1$ circularly ordered with $y_0:=x$ and such that $H(y_i)=\frac{i}{q}+H(x)$, where $H:\TT^1\to \TT^1$ is the semi-conjugacy between $F$ and $R_\alpha$ given by \mcref{ADS:theorem_irrational_rotation_number}. By \mcref{ADS:lema_alpha_i}, we have that $\exists! k_i\in\{0,\ldots,q-1\}$ such that $H(x)+i\alpha\in\left( H(x)+ \frac{k_i}{q},H(x)+\frac{k_i+1}{q}\right)$. This implies that $F^i(x)\in [y_{k_i},y_{k_i+1}]=:I_i$ because $H(x) + i\alpha={R_\alpha}^i\circ H(x) = H\circ F^i(x)$ and $H$ is increasing (thought in $[0,1]$). Now, we have:
    \begin{multline*}
      \abs{\sum_{i=1}^q \psi(F^i(x))-q\int_{\TT^1}\psi\dd{\mu}}=\abs{\sum_{i=1}^q\!\! \left(\psi(F^i(x))-q\!\int_{I_i}\! \psi\dd{\mu}\!\right)}\\
      =\abs{\sum_{i=1}^q q\left(\int_{I_i}\psi(F^i(x))-\psi (t)\dd{\mu(t)}\right)}\leq\\
      \leq q \sum_{i=1}^q \sup_{t\in I_i}\abs{\psi(F^i(x))-\psi(t)}\mu(I_i)=\\
      =\sum_{i=1}^q \abs{\psi(F^i(x))-\psi(t_i)}\leq \sum_{i=1}^q \Var(\psi|_{I_i})= \Var(\psi)
    \end{multline*}
    where in the first equality we have used that:
    \begin{multline*}
      \mu(I_i)=\mu(F^{-1}(I_i))=\mu(F^{-1}(H^{-1}(J_i)))=\\=\mu(H^{-1}({R_\alpha}^{-1}(J_i)))=\mu(H^{-1}(J_i))=\text{Leb}(J_i)=\frac{1}{q}
    \end{multline*}
    where $J_i=[H(y_{k_i}),H(y_{{k_i}+1})]$. Here we used first the invariance of $\mu$, then the semi-conjugacy property of $H$, the fact that $H_*\mu$ is invariant under $R_\alpha$ and lastly $H_*\mu = \text{Leb}$. The value $t_i\in I_i$ above is because the supremum is reached at some point, as the intervals are closed.
  \end{proof}
  \begin{lemma}\label{ADS:lema_var_log}
    Let $f\in \mathcal{D}^1(\TT^1)$. $Df$ has bounded variation if and only if $\log Df$ has bounded variation.
  \end{lemma}
  \begin{theorem}[Denjoy theorem]
    Let $F\in \Diffplus^1(\TT^1)$ with $\rho(F)\notin\quot{\QQ}{\ZZ}$ and $f\in\mathcal{D}^1(\TT^1)$ be a lift of $F$ whose derivative $Df$ has bounded variation. Then, $F$ is topologically conjugated to $R_{\rho(F)}$.
  \end{theorem}
  \begin{proof}
    By \mcref{ADS:theorem_irrational_rotation_number} it suffices to show that $F$ has no wandering intervals. We argue by contraction. Assume that $J\subseteq \TT^1$ is a wandering interval, i.e.\ $\forall n\in\ZZ^*$, $F^n(J)\cap J=\varnothing$. This implies that $F^n(J) \cap F^m(J)=\varnothing$ if $n\ne m$ and since $\sum_{n\in\ZZ}\text{Leb}(F^n(J))\leq 1$, we must have $\text{Leb}(F^n(J))\overset{n\to\infty}{\longrightarrow}0$. By assumption, $\Var(Df)<\infty$, so by \mcref{ADS:lema_var_log}, we have $\Var(\log Df) < \infty$.
    By \mcref{ADS:lema_pnqn}, $\exists \frac{p_n}{q_n}\in\QQ$ such that $\abs{\alpha-\frac{p_n}{q_n}}\leq \frac{1}{{q_n}^2}$ and $q_n\overset{n\to\infty}{\longrightarrow}+\infty$. Now use \mnameref{ADS:denjoy_koksma} applied to $\psi=\log Df$ and the sequence $\frac{p_n}{q_n}$:
    \begin{multline*}
      \abs{\sum_{i=0}^{q_n-1}\log Df(F^i(x))-q\int_{\TT^1}\log Df\dd{\mu}}=\\=\abs{\sum_{i=0}^{q_n-1}\log Df(F^i(x))}\leq\Var(\log Df)=:V
    \end{multline*}
    But $$
      \sum_{i=0}^{q_n-1}\log Df(F^i(x))=\sum_{i=0}^{q_n-1}\log Df(f^i(x))=\log Df^{q_n}(x)
    $$
    Thus, $-V\leq \log Df^{q_n}\leq V$, and so $\exp{-V}\leq Df^{q_n}\leq \exp{V}$. Hence, using the mean value theorem $\forall x,y\in\RR$ we have:
    $$
      \exp{-V}\abs{x-y}\leq \abs{f^{q_n}(x)-f^{q_n}(y)}\leq\exp{V}\abs{x-y}
    $$
    Applying this to the extremities of $J$, we have:
    $$
      \exp{-V}\text{Leb}(J)\leq \text{Leb}(F^{q_n}(J))\leq \exp{V}\text{Leb}(J)
    $$
    Since $q_n\overset{n\to\infty}{\longrightarrow}+\infty$, this contradicts the fact that $\text{Leb}(F^n(J))\overset{n\to\infty}{\longrightarrow}0$.
  \end{proof}
\end{multicols}
\end{document}